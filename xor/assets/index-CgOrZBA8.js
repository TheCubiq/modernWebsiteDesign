var Kt=Object.defineProperty;var Gt=(s,e,t)=>e in s?Kt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var le=(s,e,t)=>(Gt(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function x(){}const Le=s=>s;function z(s,e){for(const t in e)s[t]=e[t];return s}function Ot(s){return s()}function et(){return Object.create(null)}function H(s){s.forEach(Ot)}function Pe(s){return typeof s=="function"}function D(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}function Jt(s){return Object.keys(s).length===0}function Pt(s,...e){if(s==null){for(const n of e)n(void 0);return x}const t=s.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Vt(s,e,t){s.$$.on_destroy.push(Pt(e,t))}function De(s,e,t,n){if(s){const i=Tt(s,e,t,n);return s[0](i)}}function Tt(s,e,t,n){return s[1]&&n?z(t.ctx.slice(),s[1](n(e))):t.ctx}function We(s,e,t,n){if(s[2]&&n){const i=s[2](n(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],r=Math.max(e.dirty.length,i.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|i[l];return o}return e.dirty|i}return e.dirty}function Ke(s,e,t,n,i,o){if(i){const r=Tt(e,t,n,o);s.p(r,i)}}function Ge(s){if(s.ctx.length>32){const e=[],t=s.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function ge(s){const e={};for(const t in s)t[0]!=="$"&&(e[t]=s[t]);return e}function tt(s,e){const t={};e=new Set(e);for(const n in s)!e.has(n)&&n[0]!=="$"&&(t[n]=s[n]);return t}function nt(s){const e=typeof s=="string"&&s.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[s,"px"]}const Et=typeof window<"u";let ve=Et?()=>window.performance.now():()=>Date.now(),Je=Et?s=>requestAnimationFrame(s):x;const fe=new Set;function It(s){fe.forEach(e=>{e.c(s)||(fe.delete(e),e.f())}),fe.size!==0&&Je(It)}function $e(s){let e;return fe.size===0&&Je(It),{promise:new Promise(t=>{fe.add(e={c:s,f:t})}),abort(){fe.delete(e)}}}const At=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;class Te{constructor(e){le(this,"_listeners","WeakMap"in At?new WeakMap:void 0);le(this,"_observer");le(this,"options");this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(e=>{var t;for(const n of e)Te.entries.set(n.target,n),(t=this._listeners.get(n.target))==null||t(n)}))}}Te.entries="WeakMap"in At?new WeakMap:void 0;function U(s,e){s.appendChild(e)}function Rt(s){if(!s)return document;const e=s.getRootNode?s.getRootNode():s.ownerDocument;return e&&e.host?e:s.ownerDocument}function Ht(s){const e=K("style");return e.textContent="/* empty */",Qt(Rt(s),e),e.sheet}function Qt(s,e){return U(s.head||s,e),e.sheet}function N(s,e,t){s.insertBefore(e,t||null)}function R(s){s.parentNode&&s.parentNode.removeChild(s)}function Ve(s,e){for(let t=0;t<s.length;t+=1)s[t]&&s[t].d(e)}function K(s){return document.createElement(s)}function te(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function _e(s){return document.createTextNode(s)}function ue(){return _e(" ")}function be(){return _e("")}function ee(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function st(s){return function(e){return e.preventDefault(),s.call(this,e)}}function v(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function Ae(s,e){for(const t in e)v(s,t,e[t])}function Zt(s){return Array.from(s.childNodes)}function it(s,e){e=""+e,s.data!==e&&(s.data=e)}function F(s,e,t,n){t==null?s.style.removeProperty(e):s.style.setProperty(e,t,n?"important":"")}const Yt=new Te({box:"border-box"});function W(s,e,t){s.classList.toggle(e,!!t)}function Xt(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}const Re=new Map;let je=0;function en(s){let e=5381,t=s.length;for(;t--;)e=(e<<5)-e^s.charCodeAt(t);return e>>>0}function tn(s,e){const t={stylesheet:Ht(e),rules:{}};return Re.set(s,t),t}function qe(s,e,t,n,i,o,r,l=0){const a=16.666/n;let c=`{
`;for(let _=0;_<=1;_+=a){const y=e+(t-e)*o(_);c+=_*100+`%{${r(y,1-y)}}
`}const d=c+`100% {${r(t,1-t)}}
}`,m=`__svelte_${en(d)}_${l}`,h=Rt(s),{stylesheet:p,rules:u}=Re.get(h)||tn(h,s);u[m]||(u[m]=!0,p.insertRule(`@keyframes ${m} ${d}`,p.cssRules.length));const w=s.style.animation||"";return s.style.animation=`${w?`${w}, `:""}${m} ${n}ms linear ${i}ms 1 both`,je+=1,m}function Ne(s,e){const t=(s.style.animation||"").split(", "),n=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=t.length-n.length;i&&(s.style.animation=n.join(", "),je-=i,je||nn())}function nn(){Je(()=>{je||(Re.forEach(s=>{const{ownerNode:e}=s.stylesheet;e&&R(e)}),Re.clear())})}let ke;function Se(s){ke=s}function sn(){if(!ke)throw new Error("Function called outside component initialization");return ke}function He(s){sn().$$.on_mount.push(s)}const he=[],ot=[];let pe=[];const rt=[],on=Promise.resolve();let Me=!1;function rn(){Me||(Me=!0,on.then(jt))}function M(s){pe.push(s)}const xe=new Set;let ae=0;function jt(){if(ae!==0)return;const s=ke;do{try{for(;ae<he.length;){const e=he[ae];ae++,Se(e),ln(e.$$)}}catch(e){throw he.length=0,ae=0,e}for(Se(null),he.length=0,ae=0;ot.length;)ot.pop()();for(let e=0;e<pe.length;e+=1){const t=pe[e];xe.has(t)||(xe.add(t),t())}pe.length=0}while(he.length);for(;rt.length;)rt.pop()();Me=!1,xe.clear(),Se(s)}function ln(s){if(s.fragment!==null){s.update(),H(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(M)}}function an(s){const e=[],t=[];pe.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),pe=e}let ye;function Qe(){return ye||(ye=Promise.resolve(),ye.then(()=>{ye=null})),ye}function oe(s,e,t){s.dispatchEvent(Xt(`${e?"intro":"outro"}${t}`))}const Ie=new Set;let G;function Ce(){G={r:0,c:[],p:G}}function Oe(){G.r||H(G.c),G=G.p}function A(s,e){s&&s.i&&(Ie.delete(s),s.i(e))}function j(s,e,t,n){if(s&&s.o){if(Ie.has(s))return;Ie.add(s),G.c.push(()=>{Ie.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}const Ze={duration:0};function qt(s,e,t){const n={direction:"in"};let i=e(s,t,n),o=!1,r,l,a=0;function c(){r&&Ne(s,r)}function d(){const{delay:h=0,duration:p=300,easing:u=Le,tick:w=x,css:_}=i||Ze;_&&(r=qe(s,0,1,p,h,u,_,a++)),w(0,1);const y=ve()+h,E=y+p;l&&l.abort(),o=!0,M(()=>oe(s,!0,"start")),l=$e(k=>{if(o){if(k>=E)return w(1,0),oe(s,!0,"end"),c(),o=!1;if(k>=y){const P=u((k-y)/p);w(P,1-P)}}return o})}let m=!1;return{start(){m||(m=!0,Ne(s),Pe(i)?(i=i(n),Qe().then(d)):d())},invalidate(){m=!1},end(){o&&(c(),o=!1)}}}function Nt(s,e,t){const n={direction:"out"};let i=e(s,t,n),o=!0,r;const l=G;l.r+=1;let a;function c(){const{delay:d=0,duration:m=300,easing:h=Le,tick:p=x,css:u}=i||Ze;u&&(r=qe(s,1,0,m,d,h,u));const w=ve()+d,_=w+m;M(()=>oe(s,!1,"start")),"inert"in s&&(a=s.inert,s.inert=!0),$e(y=>{if(o){if(y>=_)return p(0,1),oe(s,!1,"end"),--l.r||H(l.c),!1;if(y>=w){const E=h((y-w)/m);p(1-E,E)}}return o})}return Pe(i)?Qe().then(()=>{i=i(n),c()}):c(),{end(d){d&&"inert"in s&&(s.inert=a),d&&i.tick&&i.tick(1,0),o&&(r&&Ne(s,r),o=!1)}}}function de(s,e,t,n){let o=e(s,t,{direction:"both"}),r=n?0:1,l=null,a=null,c=null,d;function m(){c&&Ne(s,c)}function h(u,w){const _=u.b-r;return w*=Math.abs(_),{a:r,b:u.b,d:_,duration:w,start:u.start,end:u.start+w,group:u.group}}function p(u){const{delay:w=0,duration:_=300,easing:y=Le,tick:E=x,css:k}=o||Ze,P={start:ve()+w,b:u};u||(P.group=G,G.r+=1),"inert"in s&&(u?d!==void 0&&(s.inert=d):(d=s.inert,s.inert=!0)),l||a?a=P:(k&&(m(),c=qe(s,r,u,_,w,y,k)),u&&E(0,1),l=h(P,_),M(()=>oe(s,u,"start")),$e(T=>{if(a&&T>a.start&&(l=h(a,_),a=null,oe(s,l.b,"start"),k&&(m(),c=qe(s,r,l.b,l.duration,0,y,o.css))),l){if(T>=l.end)E(r=l.b,1-r),oe(s,l.b,"end"),a||(l.b?m():--l.group.r||H(l.group.c)),l=null;else if(T>=l.start){const L=T-l.start;r=l.a+l.d*y(L/l.duration),E(r,1-r)}}return!!(l||a)}))}return{run(u){Pe(o)?Qe().then(()=>{o=o({direction:u?"in":"out"}),p(u)}):p(u)},end(){m(),l=a=null}}}function V(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Lt(s,e){j(s,1,1,()=>{e.delete(s.key)})}function $t(s,e,t,n,i,o,r,l,a,c,d,m){let h=s.length,p=o.length,u=h;const w={};for(;u--;)w[s[u].key]=u;const _=[],y=new Map,E=new Map,k=[];for(u=p;u--;){const C=m(i,o,u),q=t(C);let g=r.get(q);g?n&&k.push(()=>g.p(C,e)):(g=c(q,C),g.c()),y.set(q,_[u]=g),q in w&&E.set(q,Math.abs(u-w[q]))}const P=new Set,T=new Set;function L(C){A(C,1),C.m(l,d),r.set(C.key,C),d=C.first,p--}for(;h&&p;){const C=_[p-1],q=s[h-1],g=C.key,f=q.key;C===q?(d=C.first,h--,p--):y.has(f)?!r.has(g)||P.has(g)?L(C):T.has(f)?h--:E.get(g)>E.get(f)?(T.add(g),L(C)):(P.add(f),h--):(a(q,r),h--)}for(;h--;){const C=s[h];y.has(C.key)||a(C,r)}for(;p;)L(_[p-1]);return H(k),_}function Ue(s,e){const t={},n={},i={$$scope:1};let o=s.length;for(;o--;){const r=s[o],l=e[o];if(l){for(const a in r)a in l||(n[a]=1);for(const a in l)i[a]||(t[a]=l[a],i[a]=1);s[o]=l}else for(const a in r)i[a]=1}for(const r in n)r in t||(t[r]=void 0);return t}function Ut(s){return typeof s=="object"&&s!==null?s:{}}function ne(s){s&&s.c()}function Z(s,e,t){const{fragment:n,after_update:i}=s.$$;n&&n.m(e,t),M(()=>{const o=s.$$.on_mount.map(Ot).filter(Pe);s.$$.on_destroy?s.$$.on_destroy.push(...o):H(o),s.$$.on_mount=[]}),i.forEach(M)}function Y(s,e){const t=s.$$;t.fragment!==null&&(an(t.after_update),H(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function cn(s,e){s.$$.dirty[0]===-1&&(he.push(s),rn(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function se(s,e,t,n,i,o,r=null,l=[-1]){const a=ke;Se(s);const c=s.$$={fragment:null,ctx:[],props:o,update:x,not_equal:i,bound:et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:et(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let d=!1;if(c.ctx=t?t(s,e.props||{},(m,h,...p)=>{const u=p.length?p[0]:h;return c.ctx&&i(c.ctx[m],c.ctx[m]=u)&&(!c.skip_bound&&c.bound[m]&&c.bound[m](u),d&&cn(s,m)),h}):[],c.update(),d=!0,H(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const m=Zt(e.target);c.fragment&&c.fragment.l(m),m.forEach(R)}else c.fragment&&c.fragment.c();e.intro&&A(s.$$.fragment),Z(s,e.target,e.anchor),jt()}Se(a)}class ie{constructor(){le(this,"$$");le(this,"$$set")}$destroy(){Y(this,1),this.$destroy=x}$on(e,t){if(!Pe(t))return x;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Jt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const un="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(un);const ce=[];function xt(s,e=x){let t;const n=new Set;function i(l){if(D(s,l)&&(s=l,t)){const a=!ce.length;for(const c of n)c[1](),ce.push(c,s);if(a){for(let c=0;c<ce.length;c+=2)ce[c][0](ce[c+1]);ce.length=0}}}function o(l){i(l(s))}function r(l,a=x){const c=[l,a];return n.add(c),n.size===1&&(t=e(i,o)||x),l(s),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:r}}function lt(s){return Object.prototype.toString.call(s)==="[object Date]"}function ze(s,e,t,n){if(typeof t=="number"||lt(t)){const i=n-t,o=(t-e)/(s.dt||1/60),r=s.opts.stiffness*i,l=s.opts.damping*o,a=(r-l)*s.inv_mass,c=(o+a)*s.dt;return Math.abs(c)<s.opts.precision&&Math.abs(i)<s.opts.precision?n:(s.settled=!1,lt(t)?new Date(t.getTime()+c):t+c)}else{if(Array.isArray(t))return t.map((i,o)=>ze(s,e[o],t[o],n[o]));if(typeof t=="object"){const i={};for(const o in t)i[o]=ze(s,e[o],t[o],n[o]);return i}else throw new Error(`Cannot spring ${typeof t} values`)}}function hn(s,e={}){const t=xt(s),{stiffness:n=.15,damping:i=.8,precision:o=.01}=e;let r,l,a,c=s,d=s,m=1,h=0,p=!1;function u(_,y={}){d=_;const E=a={};return s==null||y.hard||w.stiffness>=1&&w.damping>=1?(p=!0,r=ve(),c=_,t.set(s=d),Promise.resolve()):(y.soft&&(h=1/((y.soft===!0?.5:+y.soft)*60),m=0),l||(r=ve(),p=!1,l=$e(k=>{if(p)return p=!1,l=null,!1;m=Math.min(m+h,1);const P={inv_mass:m,opts:w,settled:!0,dt:(k-r)*60/1e3},T=ze(P,c,s,d);return r=k,c=s,t.set(s=T),P.settled&&(l=null),!P.settled})),new Promise(k=>{l.promise.then(()=>{E===a&&k()})}))}const w={set:u,update:(_,y)=>u(_(d,s),y),subscribe:t.subscribe,stiffness:n,damping:i,precision:o};return w}function dn(s){return s<.5?4*s*s*s:.5*Math.pow(2*s-2,3)+1}function fn(s){const e=s-1;return e*e*e+1}function Q(s,{delay:e=0,duration:t=400,easing:n=Le}={}){const i=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:n,css:o=>`opacity: ${o*i}`}}function pn(s,{delay:e=0,duration:t=400,easing:n=fn,x:i=0,y:o=0,opacity:r=0}={}){const l=getComputedStyle(s),a=+l.opacity,c=l.transform==="none"?"":l.transform,d=a*(1-r),[m,h]=nt(i),[p,u]=nt(o);return{delay:e,duration:t,easing:n,css:(w,_)=>`
			transform: ${c} translate(${(1-w)*m}${h}, ${(1-w)*p}${u});
			opacity: ${a-d*_}`}}const mn={square:{origin:{x:1,y:1},path:[{x:0,y:0},{x:2,y:0},{x:2,y:2},{x:0,y:2}]},triangle:{origin:{x:1,y:1},path:[{x:0,y:0},{x:2,y:0},{x:0,y:2}]}},J=15,gn=!1;function bn(s){let e,t,n,i,o,r,l,a,c,d;return{c(){e=K("div"),t=te("svg"),n=te("path"),v(n,"d",i=s[7](s[1].path)),v(n,"class","svelte-7o3efv"),v(t,"width","100%"),v(t,"height","100%"),v(t,"viewBox",o=s[8](s[1].origin)),v(t,"preserveAspectRatio","none"),v(t,"fill","currentColor"),v(t,"class","svelte-7o3efv"),v(e,"role","cell"),v(e,"tabindex","-1"),v(e,"class","svelte-7o3efv"),F(e,"--y",`${s[2].y}%`),F(e,"--x",`${s[2].x}%`)},m(m,h){N(m,e,h),U(e,t),U(t,n),a=!0,c||(d=[ee(window,"mousemove",s[4]),ee(window,"touchmove",s[4]),ee(window,"mouseup",s[6]),ee(window,"touchend",s[6]),ee(e,"mousedown",st(s[5])),ee(e,"touchstart",st(s[5]))],c=!0)},p(m,[h]){s=m,(!a||h&2&&i!==(i=s[7](s[1].path)))&&v(n,"d",i),(!a||h&2&&o!==(o=s[8](s[1].origin)))&&v(t,"viewBox",o),h&4&&F(e,"--y",`${s[2].y}%`),h&4&&F(e,"--x",`${s[2].x}%`)},i(m){a||(M(()=>{a&&(l&&l.end(1),r=qt(e,Q,{duration:100,delay:s[9]}),r.start())}),a=!0)},o(m){r&&r.invalidate(),l=Nt(e,pn,{y:300,duration:2e3,delay:200+s[0]*100,easing:dn}),a=!1},d(m){m&&R(e),m&&l&&l.end(),c=!1,H(d)}}}function yn(s,e,t){let n,{id:i}=e,{shapeSkin:o}=e,{boardPoints:r=[]}=e,{blockSize:l=1}=e,a=!1,c={x:0,y:0},{shapePos:d={x:0,y:0}}=e,{shape:m}=e;const h=g=>g/l,p=()=>Math.random()*100,u=hn({x:p(),y:p()},{stiffness:.1,damping:.25});Vt(s,u,g=>t(2,n=g));const w=g=>{let f=g.touches?g.touches[0]:g;return{x:f.clientX,y:f.clientY}},_=g=>{if(!a)return;const f=w(g);a&&u.set({x:h(f.x)*100-c.x,y:h(f.y)*100-c.y})},y=g=>{a=!0;const f=w(g),S=g.touches?30:0;c={x:h(f.x)*100-n.x,y:h(f.y+S)*100-n.y}},E=(g,f)=>r.flat().reduce((I,b)=>{const O=Math.sqrt((b.x-g)**2+(b.y-f)**2);return O<I.distance?{distance:O,point:b}:I},{distance:1/0,point:{x:0,y:0}}).point,k=(g,f=!1)=>{const{x:S,y:I}=E(g.x,g.y);u.set({x:S/J*100,y:I/J*100}),f&&m.setPos({x:S+.5,y:I+.5})},P=()=>{a&&(a=!1,k({x:n.x/100*J,y:n.y/100*J},!0))},T=g=>g.map((f,S)=>`${S===0?"M":"L"} ${f.x} ${f.y}`).join(" ")+" Z",L=(g,f={x:1,y:1})=>`${g.x} ${g.y} ${f.x} ${f.y}`;let C=100*i+500,q=!1;return He(()=>{setTimeout(()=>{t(14,q=!0)},C)}),s.$$set=g=>{"id"in g&&t(0,i=g.id),"shapeSkin"in g&&t(1,o=g.shapeSkin),"boardPoints"in g&&t(10,r=g.boardPoints),"blockSize"in g&&t(11,l=g.blockSize),"shapePos"in g&&t(12,d=g.shapePos),"shape"in g&&t(13,m=g.shape)},s.$$.update=()=>{s.$$.dirty&20480&&q&&k(d)},[i,o,n,u,_,y,P,T,L,C,r,l,d,m,q]}class wn extends ie{constructor(e){super(),se(this,e,yn,bn,D,{id:0,shapeSkin:1,boardPoints:10,blockSize:11,shapePos:12,shape:13})}}class B extends Error{constructor(e){var t,n,i,o;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,B.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof B||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(o=(i=(n=this.originalError)==null?void 0:n.cause)==null?void 0:i.message)!=null&&o.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const Ee=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function _n(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},e||{}).decode||Sn;let i=0;for(;i<s.length;){const o=s.indexOf("=",i);if(o===-1)break;let r=s.indexOf(";",i);if(r===-1)r=s.length;else if(r<o){i=s.lastIndexOf(";",o-1)+1;continue}const l=s.slice(i,o).trim();if(t[l]===void 0){let a=s.slice(o+1,r).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[l]=n(a)}catch{t[l]=a}}i=r+1}return t}function at(s,e,t){const n=Object.assign({},t||{}),i=n.encode||vn;if(!Ee.test(s))throw new TypeError("argument name is invalid");const o=i(e);if(o&&!Ee.test(o))throw new TypeError("argument val is invalid");let r=s+"="+o;if(n.maxAge!=null){const l=n.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(l)}if(n.domain){if(!Ee.test(n.domain))throw new TypeError("option domain is invalid");r+="; Domain="+n.domain}if(n.path){if(!Ee.test(n.path))throw new TypeError("option path is invalid");r+="; Path="+n.path}if(n.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function Sn(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function vn(s){return encodeURIComponent(s)}let Bt;function me(s){if(s)try{const e=decodeURIComponent(Bt(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Ft(s,e=0){let t=me(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Bt=typeof atob=="function"?atob:s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,i=0,o=0,r="";n=e.charAt(o++);~n&&(t=i%4?64*t+n:n,i++%4)?r+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return r};const ct="pb_auth";class kn{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Ft(this.token)}get isAdmin(){return me(this.token).type==="admin"}get isAuthRecord(){return me(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=ct){const n=_n(e||"")[t]||"";let i={};try{i=JSON.parse(n),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)}exportToCookie(e,t=ct){var a,c;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},i=me(this.token);n.expires=i!=null&&i.exp?new Date(1e3*i.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const o={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let r=at(t,JSON.stringify(o),e);const l=typeof Blob<"u"?new Blob([r]).size:r.length;if(o.model&&l>4096){o.model={id:(a=o==null?void 0:o.model)==null?void 0:a.id,email:(c=o==null?void 0:o.model)==null?void 0:c.email};const d=["collectionId","username","verified"];for(const m in this.model)d.includes(m)&&(o.model[m]=this.model[m]);r=at(t,JSON.stringify(o),e)}return r}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class Cn extends kn{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class re{constructor(e){this.client=e}}class On extends re{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n){return n=Object.assign({method:"POST",body:{email:e,template:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(e,t,n,i,o,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:i,duration:o}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}class Ye extends re{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(i=>{var o;return i.items=((o=i.items)==null?void 0:o.map(r=>this.decode(r)))||[],i})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{var i;if(!((i=n==null?void 0:n.items)!=null&&i.length))throw new B({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}async getOne(e,t){if(!e)throw new B({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(i=>this.decode(i))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],i=async o=>this.getList(o,e||500,t).then(r=>{const l=r.items;return n=n.concat(l),l.length==r.perPage?i(o+1):n});return i(1)}}function $(s,e,t,n){const i=n!==void 0;return i||t!==void 0?i?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function Be(s){var e;(e=s._resetAutoRefresh)==null||e.call(s)}class Pn extends Ye{get baseCrudPath(){return"/api/admins"}async update(e,t,n){return super.update(e,t,n).then(i=>{var o,r;return((o=this.client.authStore.model)==null?void 0:o.id)===i.id&&((r=this.client.authStore.model)==null?void 0:r.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,i),i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,o;return n&&((i=this.client.authStore.model)==null?void 0:i.id)===e&&((o=this.client.authStore.model)==null?void 0:o.collectionId)===void 0&&this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,n,i){let o={method:"POST",body:{identity:e,password:t}};o=$("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",o,n,i);const r=o.autoRefreshThreshold;delete o.autoRefreshThreshold,o.autoRefresh||Be(this.client);let l=await this.client.send(this.baseCrudPath+"/auth-with-password",o);return l=this.authResponse(l),r&&function(c,d,m,h){Be(c);const p=c.beforeSend,u=c.authStore.model,w=c.authStore.onChange((_,y)=>{(!_||(y==null?void 0:y.id)!=(u==null?void 0:u.id)||(y!=null&&y.collectionId||u!=null&&u.collectionId)&&(y==null?void 0:y.collectionId)!=(u==null?void 0:u.collectionId))&&Be(c)});c._resetAutoRefresh=function(){w(),c.beforeSend=p,delete c._resetAutoRefresh},c.beforeSend=async(_,y)=>{var T;const E=c.authStore.token;if((T=y.query)!=null&&T.autoRefresh)return p?p(_,y):{url:_,sendOptions:y};let k=c.authStore.isValid;if(k&&Ft(c.authStore.token,d))try{await m()}catch{k=!1}k||await h();const P=y.headers||{};for(let L in P)if(L.toLowerCase()=="authorization"&&E==P[L]&&c.authStore.token){P[L]=c.authStore.token;break}return y.headers=P,p?p(_,y):{url:_,sendOptions:y}}}(this.client,r,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},o))),l}async authRefresh(e,t){let n={method:"POST"};return n=$("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",n).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=$("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCrudPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return r=$("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",r,i,o),this.client.send(this.baseCrudPath+"/confirm-password-reset",r).then(()=>!0)}}const Tn=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Mt(s){if(s){s.query=s.query||{};for(let e in s)Tn.includes(e)||(s.query[e]=s[e],delete s[e])}}class zt extends re{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){var r;if(!e)throw new Error("topic must be set.");let i=e;if(n){Mt(n);const l="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));i+=(i.includes("?")?"&":"?")+l}const o=function(l){const a=l;let c;try{c=JSON.parse(a==null?void 0:a.data)}catch{}t(c||{})};return this.subscriptions[i]||(this.subscriptions[i]=[]),this.subscriptions[i].push(o),this.isConnected?this.subscriptions[i].length===1?await this.submitSubscriptions():(r=this.eventSource)==null||r.addEventListener(i,o):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,o)}async unsubscribe(e){var n;let t=!1;if(e){const i=this.getSubscriptionsByTopic(e);for(let o in i)if(this.hasSubscriptionListeners(o)){for(let r of this.subscriptions[o])(n=this.eventSource)==null||n.removeEventListener(o,r);delete this.subscriptions[o],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var n;let t=!1;for(let i in this.subscriptions)if((i+"?").startsWith(e)){t=!0;for(let o of this.subscriptions[i])(n=this.eventSource)==null||n.removeEventListener(i,o);delete this.subscriptions[i]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var o;let n=!1;const i=this.getSubscriptionsByTopic(e);for(let r in i){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let l=!1;for(let a=this.subscriptions[r].length-1;a>=0;a--)this.subscriptions[r][a]===t&&(l=!0,delete this.subscriptions[r][a],this.subscriptions[r].splice(a,1),(o=this.eventSource)==null||o.removeEventListener(r,t));l&&(this.subscriptions[r].length||delete this.subscriptions[r],n||this.hasSubscriptionListeners(r)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,n;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let i in this.subscriptions)if((n=this.subscriptions[i])!=null&&n.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let i in n)for(let o of n[i])o(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new B(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[]}}}class En extends Ye{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(i=>{var o,r,l;return((o=this.client.authStore.model)==null?void 0:o.id)!==(i==null?void 0:i.id)||((r=this.client.authStore.model)==null?void 0:r.collectionId)!==this.collectionIdOrName&&((l=this.client.authStore.model)==null?void 0:l.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,i),i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,o,r;return!n||((i=this.client.authStore.model)==null?void 0:i.id)!==e||((o=this.client.authStore.model)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.model)==null?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,n,i){let o={method:"POST",body:{identity:e,password:t}};return o=$("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/auth-with-password",o).then(r=>this.authResponse(r))}async authWithOAuth2Code(e,t,n,i,o,r,l){let a={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectUrl:i,createData:o}};return a=$("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",a,r,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(c=>this.authResponse(c))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},n=(await this.listAuthMethods()).authProviders.find(a=>a.name===t.provider);if(!n)throw new B(new Error(`Missing or invalid provider "${t.provider}".`));const i=this.client.buildUrl("/api/oauth2-redirect"),o=new zt(this.client);let r=null;function l(){r==null||r.close(),o.unsubscribe()}return t.urlCallback||(r=ut(void 0)),new Promise(async(a,c)=>{var d;try{await o.subscribe("@oauth2",async u=>{const w=o.clientId;try{if(!u.state||w!==u.state)throw new Error("State parameters don't match.");if(u.error||!u.code)throw new Error("OAuth2 redirect error or missing code: "+u.error);const _=Object.assign({},t);delete _.provider,delete _.scopes,delete _.createData,delete _.urlCallback;const y=await this.authWithOAuth2Code(n.name,u.code,n.codeVerifier,i,t.createData,_);a(y)}catch(_){c(new B(_))}l()});const m={state:o.clientId};(d=t.scopes)!=null&&d.length&&(m.scope=t.scopes.join(" "));const h=this._replaceQueryParams(n.authUrl+i,m);await(t.urlCallback||function(u){r?r.location.href=u:r=ut(u)})(h)}catch(m){l(),c(new B(m))}})}async authRefresh(e,t){let n={method:"POST"};return n=$("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(i=>this.authResponse(i))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=$("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return r=$("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,i,o),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}async requestVerification(e,t,n){let i={method:"POST",body:{email:e}};return i=$("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}async confirmVerification(e,t,n){let i={method:"POST",body:{token:e}};return i=$("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>{const o=me(e),r=this.client.authStore.model;return r&&!r.verified&&r.id===o.id&&r.collectionId===o.collectionId&&(r.verified=!0,this.client.authStore.save(this.client.authStore.token,r)),!0})}async requestEmailChange(e,t,n){let i={method:"POST",body:{newEmail:e}};return i=$("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}async confirmEmailChange(e,t,n,i){let o={method:"POST",body:{token:e,password:t}};return o=$("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",o).then(()=>{const r=me(e),l=this.client.authStore.model;return l&&l.id===r.id&&l.collectionId===r.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),n).then(()=>!0)}_replaceQueryParams(e,t={}){let n=e,i="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const o={},r=i.split("&");for(const l of r){if(l=="")continue;const a=l.split("=");o[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let l in t)t.hasOwnProperty(l)&&(t[l]==null?delete o[l]:o[l]=t[l]);i="";for(let l in o)o.hasOwnProperty(l)&&(i!=""&&(i+="&"),i+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(o[l].replace(/%20/g,"+")));return i!=""?n+"?"+i:n}}function ut(s){if(typeof window>"u"||!(window!=null&&window.open))throw new B(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,i=window.innerHeight;e=e>n?n:e,t=t>i?i:t;let o=n/2-e/2,r=i/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+r+",left="+o+",resizable,menubar=no")}class In extends Ye{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}}class An extends re{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new B({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Rn extends re{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class jn extends re{getUrl(e,t,n={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let o=this.client.buildUrl(i.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const r=new URLSearchParams(n);o+=(o.includes("?")?"&":"?")+r}return o}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class qn extends re{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class Nn{constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=n,this.authStore=t||new Cn,this.admins=new Pn(this),this.collections=new In(this),this.files=new jn(this),this.logs=new An(this),this.settings=new On(this),this.realtime=new zt(this),this.health=new Rn(this),this.backups=new qn(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new En(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let i=t[n];switch(typeof i){case"boolean":case"number":i=""+i;break;case"string":i="'"+i.replace(/'/g,"\\'")+"'";break;default:i=i===null?"null":i instanceof Date?"'"+i.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(i).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",i)}return e}getFileUrl(e,t,n={}){return this.files.getUrl(e,t,n)}buildUrl(e){var n;let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(n=window.location.origin)!=null&&n.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildUrl(e);if(this.beforeSend){const i=Object.assign({},await this.beforeSend(n,t));i.url!==void 0||i.options!==void 0?(n=i.url||n,t=i.options||t):Object.keys(i).length&&(t=i,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=this.serializeQueryParams(t.query);i&&(n+=(n.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async i=>{let o={};try{o=await i.json()}catch{}if(this.afterSend&&(o=await this.afterSend(i,o)),i.status>=400)throw new B({url:i.url,status:i.status,data:o});return o}).catch(i=>{throw new B(i)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),Mt(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const i=new AbortController;this.cancelControllers[n]=i,t.signal=i.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(const n in e){const i=e[n];if(typeof i!="object"||this.hasBlobField({data:i})){const o=Array.isArray(i)?i:[i];for(let r of o)t.append(n,r)}else{let o={};o[n]=i,t.append("@jsonPayload",JSON.stringify(o))}}return t}hasBlobField(e){for(const t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(const i of n)if(typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const n in e){if(e[n]===null)continue;const i=e[n],o=encodeURIComponent(n);if(Array.isArray(i))for(const r of i)t.push(o+"="+encodeURIComponent(r));else i instanceof Date?t.push(o+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(o+"="+encodeURIComponent(JSON.stringify(i))):t.push(o+"="+encodeURIComponent(i))}return t.join("&")}}function ht(s,e,t){const n=s.slice();return n[1]=e[t],n}function dt(s,e,t){const n=s.slice();return n[4]=e[t],n}function ft(s){let e,t,n;return{c(){e=te("circle"),v(e,"r",".1"),v(e,"cx",t=s[4].x),v(e,"cy",n=s[4].y)},m(i,o){N(i,e,o)},p(i,o){o&1&&t!==(t=i[4].x)&&v(e,"cx",t),o&1&&n!==(n=i[4].y)&&v(e,"cy",n)},d(i){i&&R(e)}}}function pt(s){let e,t=V(s[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=ft(dt(s,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=be()},m(i,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(i,o);N(i,e,o)},p(i,o){if(o&1){t=V(i[1]);let r;for(r=0;r<t.length;r+=1){const l=dt(i,t,r);n[r]?n[r].p(l,o):(n[r]=ft(l),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&R(e),Ve(n,i)}}}function Ln(s){let e,t,n,i,o=V(s[0].boardPoints),r=[];for(let l=0;l<o.length;l+=1)r[l]=pt(ht(s,o,l));return{c(){e=te("svg");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"width","100%"),v(e,"height","100%"),v(e,"viewBox",t=`0 0 ${s[0].boardSize} ${s[0].boardSize}`),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","black"),v(e,"class","svelte-1o5z4u5")},m(l,a){N(l,e,a);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);i=!0},p(l,[a]){if(a&1){o=V(l[0].boardPoints);let c;for(c=0;c<o.length;c+=1){const d=ht(l,o,c);r[c]?r[c].p(d,a):(r[c]=pt(d),r[c].c(),r[c].m(e,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}(!i||a&1&&t!==(t=`0 0 ${l[0].boardSize} ${l[0].boardSize}`))&&v(e,"viewBox",t)},i(l){i||(n&&n.end(1),i=!0)},o(l){l&&(n=Nt(e,Q,{})),i=!1},d(l){l&&R(e),Ve(r,l),l&&n&&n.end()}}}function $n(s,e,t){let{board:n}=e;return s.$$set=i=>{"board"in i&&t(0,n=i.board)},[n]}class Un extends ie{constructor(e){super(),se(this,e,$n,Ln,D,{board:0})}}function xn(s){let e,t,n,i,o,r,l;return{c(){e=K("div"),t=te("svg"),n=te("path"),v(n,"d",i=s[2](s[0].path)),v(n,"class","svelte-7lswfc"),v(t,"width","100%"),v(t,"height","100%"),v(t,"viewBox",o=s[3](s[0].origin)),v(t,"preserveAspectRatio","none"),v(t,"fill","currentColor"),v(t,"class","svelte-7lswfc"),v(e,"role","cell"),v(e,"tabindex","-1"),v(e,"class","svelte-7lswfc"),F(e,"--y",`${s[1].x}%`),F(e,"--x",`${s[1].y}%`),F(e,"--board-size",J/we)},m(a,c){N(a,e,c),U(e,t),U(t,n),l=!0},p(a,[c]){(!l||c&1&&i!==(i=a[2](a[0].path)))&&v(n,"d",i),(!l||c&1&&o!==(o=a[3](a[0].origin)))&&v(t,"viewBox",o),c&2&&F(e,"--y",`${a[1].x}%`),c&2&&F(e,"--x",`${a[1].y}%`)},i(a){l||(M(()=>{l&&(r||(r=de(e,Q,{duration:1e3},!0)),r.run(1))}),l=!0)},o(a){r||(r=de(e,Q,{duration:1e3},!1)),r.run(0),l=!1},d(a){a&&R(e),a&&r&&r.end()}}}let we=2.5;function Bn(s,e,t){let n,{shapeSkin:i}=e,{shapePos:o={x:0,y:0}}=e;const r=a=>a.map((c,d)=>`${d===0?"M":"L"} ${c.x} ${c.y}`).join(" ")+" Z",l=(a,c={x:1,y:1})=>`${a.x} ${a.y} ${c.x} ${c.y}`;return s.$$set=a=>{"shapeSkin"in a&&t(0,i=a.shapeSkin),"shapePos"in a&&t(4,o=a.shapePos)},s.$$.update=()=>{s.$$.dirty&16&&t(1,n={x:(o.y-.5)*100*we/J-50*(we-1),y:(o.x-.5)*100*we/J-50*(we-1)})},[i,n,r,l,o]}class Fn extends ie{constructor(e){super(),se(this,e,Bn,xn,D,{shapeSkin:0,shapePos:4})}}/**
 * @license lucide-svelte v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},mt=Mn;function gt(s,e,t){const n=s.slice();return n[10]=e[t][0],n[11]=e[t][1],n}function Fe(s){let e,t=[s[11]],n={};for(let i=0;i<t.length;i+=1)n=z(n,t[i]);return{c(){e=te(s[10]),Ae(e,n)},m(i,o){N(i,e,o)},p(i,o){Ae(e,n=Ue(t,[o&32&&i[11]]))},d(i){i&&R(e)}}}function bt(s){let e=s[10],t,n=s[10]&&Fe(s);return{c(){n&&n.c(),t=be()},m(i,o){n&&n.m(i,o),N(i,t,o)},p(i,o){i[10]?e?D(e,i[10])?(n.d(1),n=Fe(i),e=i[10],n.c(),n.m(t.parentNode,t)):n.p(i,o):(n=Fe(i),e=i[10],n.c(),n.m(t.parentNode,t)):e&&(n.d(1),n=null,e=i[10])},d(i){i&&R(t),n&&n.d(i)}}}function zn(s){let e,t,n,i,o,r=V(s[5]),l=[];for(let h=0;h<r.length;h+=1)l[h]=bt(gt(s,r,h));const a=s[9].default,c=De(a,s,s[8],null);let d=[mt,s[6],{width:s[2]},{height:s[2]},{stroke:s[1]},{"stroke-width":n=s[4]?Number(s[3])*24/Number(s[2]):s[3]},{class:i=`lucide-icon lucide lucide-${s[0]} ${s[7].class??""}`}],m={};for(let h=0;h<d.length;h+=1)m=z(m,d[h]);return{c(){e=te("svg");for(let h=0;h<l.length;h+=1)l[h].c();t=be(),c&&c.c(),Ae(e,m)},m(h,p){N(h,e,p);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);U(e,t),c&&c.m(e,null),o=!0},p(h,[p]){if(p&32){r=V(h[5]);let u;for(u=0;u<r.length;u+=1){const w=gt(h,r,u);l[u]?l[u].p(w,p):(l[u]=bt(w),l[u].c(),l[u].m(e,t))}for(;u<l.length;u+=1)l[u].d(1);l.length=r.length}c&&c.p&&(!o||p&256)&&Ke(c,a,h,h[8],o?We(a,h[8],p,null):Ge(h[8]),null),Ae(e,m=Ue(d,[mt,p&64&&h[6],(!o||p&4)&&{width:h[2]},(!o||p&4)&&{height:h[2]},(!o||p&2)&&{stroke:h[1]},(!o||p&28&&n!==(n=h[4]?Number(h[3])*24/Number(h[2]):h[3]))&&{"stroke-width":n},(!o||p&129&&i!==(i=`lucide-icon lucide lucide-${h[0]} ${h[7].class??""}`))&&{class:i}]))},i(h){o||(A(c,h),o=!0)},o(h){j(c,h),o=!1},d(h){h&&R(e),Ve(l,h),c&&c.d(h)}}}function Dn(s,e,t){const n=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"];let i=tt(e,n),{$$slots:o={},$$scope:r}=e,{name:l}=e,{color:a="currentColor"}=e,{size:c=24}=e,{strokeWidth:d=2}=e,{absoluteStrokeWidth:m=!1}=e,{iconNode:h}=e;return s.$$set=p=>{t(7,e=z(z({},e),ge(p))),t(6,i=tt(e,n)),"name"in p&&t(0,l=p.name),"color"in p&&t(1,a=p.color),"size"in p&&t(2,c=p.size),"strokeWidth"in p&&t(3,d=p.strokeWidth),"absoluteStrokeWidth"in p&&t(4,m=p.absoluteStrokeWidth),"iconNode"in p&&t(5,h=p.iconNode),"$$scope"in p&&t(8,r=p.$$scope)},e=ge(e),[l,a,c,d,m,h,i,e,r,o]}class Dt extends ie{constructor(e){super(),se(this,e,Dn,zn,D,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5})}}function Wn(s){let e;const t=s[2].default,n=De(t,s,s[3],null);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8)&&Ke(n,t,i,i[3],e?We(t,i[3],o,null):Ge(i[3]),null)},i(i){e||(A(n,i),e=!0)},o(i){j(n,i),e=!1},d(i){n&&n.d(i)}}}function Kn(s){let e,t;const n=[{name:"chevron-left"},s[1],{iconNode:s[0]}];let i={$$slots:{default:[Wn]},$$scope:{ctx:s}};for(let o=0;o<n.length;o+=1)i=z(i,n[o]);return e=new Dt({props:i}),{c(){ne(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,[r]){const l=r&3?Ue(n,[n[0],r&2&&Ut(o[1]),r&1&&{iconNode:o[0]}]):{};r&8&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){j(e.$$.fragment,o),t=!1},d(o){Y(e,o)}}}function Gn(s,e,t){let{$$slots:n={},$$scope:i}=e;const o=[["path",{d:"m15 18-6-6 6-6"}]];return s.$$set=r=>{t(1,e=z(z({},e),ge(r))),"$$scope"in r&&t(3,i=r.$$scope)},e=ge(e),[o,e,n,i]}class Jn extends ie{constructor(e){super(),se(this,e,Gn,Kn,D,{})}}function Vn(s){let e;const t=s[2].default,n=De(t,s,s[3],null);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8)&&Ke(n,t,i,i[3],e?We(t,i[3],o,null):Ge(i[3]),null)},i(i){e||(A(n,i),e=!0)},o(i){j(n,i),e=!1},d(i){n&&n.d(i)}}}function Hn(s){let e,t;const n=[{name:"chevron-right"},s[1],{iconNode:s[0]}];let i={$$slots:{default:[Vn]},$$scope:{ctx:s}};for(let o=0;o<n.length;o+=1)i=z(i,n[o]);return e=new Dt({props:i}),{c(){ne(e.$$.fragment)},m(o,r){Z(e,o,r),t=!0},p(o,[r]){const l=r&3?Ue(n,[n[0],r&2&&Ut(o[1]),r&1&&{iconNode:o[0]}]):{};r&8&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(A(e.$$.fragment,o),t=!0)},o(o){j(e.$$.fragment,o),t=!1},d(o){Y(e,o)}}}function Qn(s,e,t){let{$$slots:n={},$$scope:i}=e;const o=[["path",{d:"m9 18 6-6-6-6"}]];return s.$$set=r=>{t(1,e=z(z({},e),ge(r))),"$$scope"in r&&t(3,i=r.$$scope)},e=ge(e),[o,e,n,i]}class Zn extends ie{constructor(e){super(),se(this,e,Qn,Hn,D,{})}}function yt(s,e,t){const n=s.slice();return n[20]=e[t],n}function wt(s,e,t){const n=s.slice();return n[20]=e[t],n[24]=t,n}function _t(s,e){let t,n,i;return n=new Fn({props:{shapePos:e[20].pos,shapeSkin:e[20].loadSkin()}}),{key:s,first:null,c(){t=be(),ne(n.$$.fragment),this.first=t},m(o,r){N(o,t,r),Z(n,o,r),i=!0},p(o,r){e=o;const l={};r&8&&(l.shapePos=e[20].pos),r&8&&(l.shapeSkin=e[20].loadSkin()),n.$set(l)},i(o){i||(A(n.$$.fragment,o),i=!0)},o(o){j(n.$$.fragment,o),i=!1},d(o){o&&R(t),Y(n,o)}}}function St(s){let e=[],t=new Map,n,i,o=V(s[3]);const r=l=>l[24];for(let l=0;l<o.length;l+=1){let a=wt(s,o,l),c=r(a);t.set(c,e[l]=_t(c,a))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();n=be()},m(l,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(l,a);N(l,n,a),i=!0},p(l,a){a&8&&(o=V(l[3]),Ce(),e=$t(e,a,r,1,l,o,t,n.parentNode,Lt,_t,n,wt),Oe())},i(l){if(!i){for(let a=0;a<o.length;a+=1)A(e[a]);i=!0}},o(l){for(let a=0;a<e.length;a+=1)j(e[a]);i=!1},d(l){l&&R(n);for(let a=0;a<e.length;a+=1)e[a].d(l)}}}function vt(s){let e=[],t=new Map,n,i,o,r=V(s[7]);const l=a=>a[20].id;for(let a=0;a<r.length;a+=1){let c=yt(s,r,a),d=l(c);t.set(d,e[a]=kt(d,c))}return i=new Un({props:{board:s[8]}}),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=ue(),ne(i.$$.fragment)},m(a,c){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(a,c);N(a,n,c),Z(i,a,c),o=!0},p(a,c){c&448&&(r=V(a[7]),Ce(),e=$t(e,c,l,1,a,r,t,n.parentNode,Lt,kt,n,yt),Oe())},i(a){if(!o){for(let c=0;c<r.length;c+=1)A(e[c]);A(i.$$.fragment,a),o=!0}},o(a){for(let c=0;c<e.length;c+=1)j(e[c]);j(i.$$.fragment,a),o=!1},d(a){a&&R(n);for(let c=0;c<e.length;c+=1)e[c].d(a);Y(i,a)}}}function kt(s,e){let t,n,i;return n=new wn({props:{id:e[20].id,shapePos:e[20].pos,boardPoints:e[8].boardPoints,blockSize:e[6],shapeSkin:e[20].loadSkin(),shape:e[20]}}),{key:s,first:null,c(){t=be(),ne(n.$$.fragment),this.first=t},m(o,r){N(o,t,r),Z(n,o,r),i=!0},p(o,r){e=o;const l={};r&128&&(l.id=e[20].id),r&128&&(l.shapePos=e[20].pos),r&64&&(l.blockSize=e[6]),r&128&&(l.shapeSkin=e[20].loadSkin()),r&128&&(l.shape=e[20]),n.$set(l)},i(o){i||(A(n.$$.fragment,o),i=!0)},o(o){j(n.$$.fragment,o),i=!1},d(o){o&&R(t),Y(n,o)}}}function Yn(s){let e,t=s[2]+1+"",n,i,o,r,l,a=s[2],c,d,m,h,p,u,w,_,y,E,k,P,T,L,C,q,g,f=St(s),S=!s[1]&&vt(s);_=new Jn({props:{color:"black",size:"1em"}}),P=new Zn({props:{color:"black",size:"1em"}});let I=gn;return{c(){e=K("span"),n=_e(t),i=_e("/"),o=_e(s[4]),r=ue(),l=K("div"),f.c(),c=ue(),d=K("div"),S&&S.c(),p=ue(),u=K("nav"),w=K("button"),ne(_.$$.fragment),E=ue(),k=K("button"),ne(P.$$.fragment),L=ue(),v(e,"class","svelte-xym2gw"),W(e,"active",s[1]),v(l,"class","preview svelte-xym2gw"),W(l,"completed",s[1]),F(l,"--board-size",s[8].boardSize),v(d,"class","board svelte-xym2gw"),W(d,"completed",s[1]),F(d,"--board-size",s[8].boardSize),v(w,"class","svelte-xym2gw"),W(w,"active",s[1]),v(k,"class","svelte-xym2gw"),W(k,"active",s[1]),v(u,"class","svelte-xym2gw")},m(b,O){N(b,e,O),U(e,n),U(e,i),U(e,o),N(b,r,O),N(b,l,O),f.m(l,null),N(b,c,O),N(b,d,O),S&&S.m(d,null),m=Yt.observe(d,s[10].bind(d)),N(b,p,O),N(b,u,O),U(u,w),Z(_,w,null),U(u,E),U(u,k),Z(P,k,null),U(u,L),C=!0,q||(g=[ee(w,"click",s[11]),ee(k,"click",s[12])],q=!0)},p(b,[O]){(!C||O&4)&&t!==(t=b[2]+1+"")&&it(n,t),(!C||O&16)&&it(o,b[4]),(!C||O&2)&&W(e,"active",b[1]),O&4&&D(a,a=b[2])?(Ce(),j(f,1,1,x),Oe(),f=St(b),f.c(),A(f,1),f.m(l,null)):f.p(b,O),(!C||O&2)&&W(l,"completed",b[1]),b[1]?S&&(Ce(),j(S,1,1,()=>{S=null}),Oe()):S?(S.p(b,O),O&2&&A(S,1)):(S=vt(b),S.c(),A(S,1),S.m(d,null)),(!C||O&2)&&W(d,"completed",b[1]),(!C||O&2)&&W(w,"active",b[1]),(!C||O&2)&&W(k,"active",b[1])},i(b){C||(A(f),A(S),h||M(()=>{h=qt(d,Q,{duration:500}),h.start()}),A(_.$$.fragment,b),b&&M(()=>{C&&(y||(y=de(w,Q,{},!0)),y.run(1))}),A(P.$$.fragment,b),b&&M(()=>{C&&(T||(T=de(k,Q,{},!0)),T.run(1))}),A(I),C=!0)},o(b){j(f),j(S),j(_.$$.fragment,b),b&&(y||(y=de(w,Q,{},!1)),y.run(0)),j(P.$$.fragment,b),b&&(T||(T=de(k,Q,{},!1)),T.run(0)),j(I),C=!1},d(b){b&&(R(e),R(r),R(l),R(c),R(d),R(p),R(u)),f.d(b),S&&S.d(),m(),Y(_),b&&y&&y.end(),Y(P),b&&T&&T.end(),q=!1,H(g)}}}function Xn(s,e,t){let n,i,o,r=x,l=()=>(r(),r=Pt(i,g=>t(7,o=g)),i);s.$$.on_destroy.push(()=>r());const a=new Nn("https://db.cubiq.dev/");let c=!1,d=0;const m=(g,f)=>Math.round(g*10**f)/10**f;class h{constructor(f,S,I,b){this.id=S,this.pos=I||{x:8,y:8},this.skin=b||"square",this.boardRef=f}setPos(f){this.pos=f,this.boardRef.checkBoardState()}loadSkin(){return mn[this.skin]}}class p{constructor(f){this.boardSize=f||15,this.boardShapes$=xt([]),this.boardPoints=this.generateBoardSnapPoints(this.boardSize),this.currentLevel=1,this.final=[]}addShape(f,S){this.boardShapes$.update(I=>{const b=new h(this,I.length+1,f,S);return[...I,b]})}setupLevel(f,S){this.currentLevel=S+1,this.boardShapes$.set(f.start.map((b,O)=>new h(this,O,b.pos,b.skin))),this.finalCenter=this.findCenterFromShapes(f.final);const I=this.relativeToCenter(this.finalCenter,{x:J/2+.5,y:J/2+.5});this.final=f.final.map((b,O)=>new h(null,O,this.relativeToCenter(b.pos,I),b.skin))}findCenterFromShapes(f){const S=f.reduce((I,b)=>({x:I.x+b.pos.x,y:I.y+b.pos.y}),{x:0,y:0});return{x:S.x/f.length,y:S.y/f.length}}relativeToCenter(f,S){return{x:m(f.x-S.x,2),y:m(f.y-S.y,2)}}getJSON(f){return JSON.stringify(f.map(({boardRef:S,id:I,...b})=>b))}checkBoardState(f=!1){this.boardShapes$.update(S=>(f?console.log(this.getJSON(S)):t(1,c=this.checkLevelCompletion(S)),S))}areCoordsSame(f,S){return f.x===S.x&&f.y===S.y}checkLevelCompletion(f){const S=this.final,I=this.findCenterFromShapes(f),b=this.findCenterFromShapes(S),O=S.map(X=>({skin:X.skin,pos:this.relativeToCenter(X.pos,b)}));return f.every((X,is)=>{const Wt=this.relativeToCenter(X.pos,I);return O.some(Xe=>Xe.skin===X.skin&&this.areCoordsSame(Wt,Xe.pos))})}generateBoardSnapPoints(f){const S=(I,b,O)=>Math.sqrt(I**2+b**2)<=O;return Array(f).fill().map((I,b)=>Array(f).fill().map((O,X)=>({x:b+.5,y:X+.5})).filter((O,X)=>S(O.x/f-.5,O.y/f-.5,.5)))}}let u;const w=new p(J);let _=[];const y=async()=>{const g=await a.collection("levels").getList(1,1).catch(S=>console.error(S)),{totalItems:f}=g||{totalItems:0};return f},E=async g=>{a.collection("levels").getFirstListItem("levelId="+g).then(f=>{t(1,c=!1),console.log(f),w.setupLevel(f,g),t(3,_=w.final)}).catch(f=>{console.error(f)})};let k=0;const P=(g=1)=>{t(2,d=(d+g+k)%k),E(d)};He(async()=>{t(4,k=await y()),t(2,d=0),E(d)});function T(){var g;u=(g=Te.entries.get(this))==null?void 0:g.borderBoxSize,t(0,u)}const L=()=>P(-1),C=()=>P(),q=()=>w.checkBoardState(!0);return s.$$.update=()=>{s.$$.dirty&1&&t(6,n=u?u[0].blockSize:0)},l(t(5,i=w.boardShapes$)),[u,c,d,_,k,i,n,o,w,P,T,L,C,q]}class es extends ie{constructor(e){super(),se(this,e,Xn,Yn,D,{})}}function Ct(s){let e,t;return e=new es({}),{c(){ne(e.$$.fragment)},m(n,i){Z(e,n,i),t=!0},i(n){t||(A(e.$$.fragment,n),t=!0)},o(n){j(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ts(s){let e,t,n=s[0]&&Ct();return{c(){e=K("main"),n&&n.c(),v(e,"class","svelte-udrhtm")},m(i,o){N(i,e,o),n&&n.m(e,null),t=!0},p(i,[o]){i[0]?n?o&1&&A(n,1):(n=Ct(),n.c(),A(n,1),n.m(e,null)):n&&(Ce(),j(n,1,1,()=>{n=null}),Oe())},i(i){t||(A(n),t=!0)},o(i){j(n),t=!1},d(i){i&&R(e),n&&n.d()}}}function ns(s,e,t){let n=!1;return He(()=>{setTimeout(()=>{t(0,n=!0)},300)}),[n]}class ss extends ie{constructor(e){super(),se(this,e,ns,ts,D,{})}}new ss({target:document.getElementById("app")});
