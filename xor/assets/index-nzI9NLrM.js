var Xt=Object.defineProperty;var en=(s,e,t)=>e in s?Xt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ae=(s,e,t)=>(en(s,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function N(){}const ze=s=>s;function x(s,e){for(const t in e)s[t]=e[t];return s}function Rt(s){return s()}function it(){return Object.create(null)}function Z(s){s.forEach(Rt)}function Te(s){return typeof s=="function"}function M(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}function tn(s){return Object.keys(s).length===0}function Ke(s,...e){if(s==null){for(const n of e)n(void 0);return N}const t=s.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function qt(s,e,t){s.$$.on_destroy.push(Ke(e,t))}function He(s,e,t,n){if(s){const i=jt(s,e,t,n);return s[0](i)}}function jt(s,e,t,n){return s[1]&&n?x(t.ctx.slice(),s[1](n(e))):t.ctx}function Qe(s,e,t,n){if(s[2]&&n){const i=s[2](n(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],r=Math.max(e.dirty.length,i.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|i[l];return o}return e.dirty|i}return e.dirty}function Ze(s,e,t,n,i,o){if(i){const r=jt(e,t,n,o);s.p(r,i)}}function Ye(s){if(s.ctx.length>32){const e=[],t=s.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function ge(s){const e={};for(const t in s)t[0]!=="$"&&(e[t]=s[t]);return e}function ot(s,e){const t={};e=new Set(e);for(const n in s)!e.has(n)&&n[0]!=="$"&&(t[n]=s[n]);return t}function rt(s,e,t){return s.set(t),e}function lt(s){const e=typeof s=="string"&&s.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[s,"px"]}const Lt=typeof window<"u";let ke=Lt?()=>window.performance.now():()=>Date.now(),Xe=Lt?s=>requestAnimationFrame(s):N;const fe=new Set;function Nt(s){fe.forEach(e=>{e.c(s)||(fe.delete(e),e.f())}),fe.size!==0&&Xe(Nt)}function $e(s){let e;return fe.size===0&&Xe(Nt),{promise:new Promise(t=>{fe.add(e={c:s,f:t})}),abort(){fe.delete(e)}}}const Ut=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;class Ee{constructor(e){ae(this,"_listeners","WeakMap"in Ut?new WeakMap:void 0);ae(this,"_observer");ae(this,"options");this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(e=>{var t;for(const n of e)Ee.entries.set(n.target,n),(t=this._listeners.get(n.target))==null||t(n)}))}}Ee.entries="WeakMap"in Ut?new WeakMap:void 0;function z(s,e){s.appendChild(e)}function zt(s){if(!s)return document;const e=s.getRootNode?s.getRootNode():s.ownerDocument;return e&&e.host?e:s.ownerDocument}function nn(s){const e=J("style");return e.textContent="/* empty */",sn(zt(s),e),e.sheet}function sn(s,e){return z(s.head||s,e),e.sheet}function R(s,e,t){s.insertBefore(e,t||null)}function I(s){s.parentNode&&s.parentNode.removeChild(s)}function et(s,e){for(let t=0;t<s.length;t+=1)s[t]&&s[t].d(e)}function J(s){return document.createElement(s)}function se(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Se(s){return document.createTextNode(s)}function ie(){return Se(" ")}function be(){return Se("")}function te(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function at(s){return function(e){return e.preventDefault(),s.call(this,e)}}function _(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function Re(s,e){for(const t in e)_(s,t,e[t])}function on(s){return Array.from(s.childNodes)}function ct(s,e){e=""+e,s.data!==e&&(s.data=e)}function D(s,e,t,n){t==null?s.style.removeProperty(e):s.style.setProperty(e,t,n?"important":"")}const rn=new Ee({box:"border-box"});function B(s,e,t){s.classList.toggle(e,!!t)}function ln(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}const qe=new Map;let je=0;function an(s){let e=5381,t=s.length;for(;t--;)e=(e<<5)-e^s.charCodeAt(t);return e>>>0}function cn(s,e){const t={stylesheet:nn(e),rules:{}};return qe.set(s,t),t}function Le(s,e,t,n,i,o,r,l=0){const a=16.666/n;let c=`{
`;for(let b=0;b<=1;b+=a){const m=e+(t-e)*o(b);c+=b*100+`%{${r(m,1-m)}}
`}const h=c+`100% {${r(t,1-t)}}
}`,d=`__svelte_${an(h)}_${l}`,u=zt(s),{stylesheet:p,rules:f}=qe.get(u)||cn(u,s);f[d]||(f[d]=!0,p.insertRule(`@keyframes ${d} ${h}`,p.cssRules.length));const y=s.style.animation||"";return s.style.animation=`${y?`${y}, `:""}${d} ${n}ms linear ${i}ms 1 both`,je+=1,d}function Ne(s,e){const t=(s.style.animation||"").split(", "),n=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=t.length-n.length;i&&(s.style.animation=n.join(", "),je-=i,je||un())}function un(){Xe(()=>{je||(qe.forEach(s=>{const{ownerNode:e}=s.stylesheet;e&&I(e)}),qe.clear())})}let Ce;function ve(s){Ce=s}function hn(){if(!Ce)throw new Error("Function called outside component initialization");return Ce}function Fe(s){hn().$$.on_mount.push(s)}const he=[],ut=[];let pe=[];const ht=[],dn=Promise.resolve();let Ge=!1;function fn(){Ge||(Ge=!0,dn.then($t))}function W(s){pe.push(s)}const Me=new Set;let ce=0;function $t(){if(ce!==0)return;const s=Ce;do{try{for(;ce<he.length;){const e=he[ce];ce++,ve(e),pn(e.$$)}}catch(e){throw he.length=0,ce=0,e}for(ve(null),he.length=0,ce=0;ut.length;)ut.pop()();for(let e=0;e<pe.length;e+=1){const t=pe[e];Me.has(t)||(Me.add(t),t())}pe.length=0}while(he.length);for(;ht.length;)ht.pop()();Ge=!1,Me.clear(),ve(s)}function pn(s){if(s.fragment!==null){s.update(),Z(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(W)}}function mn(s){const e=[],t=[];pe.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),pe=e}let ye;function tt(){return ye||(ye=Promise.resolve(),ye.then(()=>{ye=null})),ye}function oe(s,e,t){s.dispatchEvent(ln(`${e?"intro":"outro"}${t}`))}const Ae=new Set;let V;function Oe(){V={r:0,c:[],p:V}}function Pe(){V.r||Z(V.c),V=V.p}function P(s,e){s&&s.i&&(Ae.delete(s),s.i(e))}function A(s,e,t,n){if(s&&s.o){if(Ae.has(s))return;Ae.add(s),V.c.push(()=>{Ae.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}const nt={duration:0};function Ft(s,e,t){const n={direction:"in"};let i=e(s,t,n),o=!1,r,l,a=0;function c(){r&&Ne(s,r)}function h(){const{delay:u=0,duration:p=300,easing:f=ze,tick:y=N,css:b}=i||nt;b&&(r=Le(s,0,1,p,u,f,b,a++)),y(0,1);const m=ke()+u,E=m+p;l&&l.abort(),o=!0,W(()=>oe(s,!0,"start")),l=$e(k=>{if(o){if(k>=E)return y(1,0),oe(s,!0,"end"),c(),o=!1;if(k>=m){const C=f((k-m)/p);y(C,1-C)}}return o})}let d=!1;return{start(){d||(d=!0,Ne(s),Te(i)?(i=i(n),tt().then(h)):h())},invalidate(){d=!1},end(){o&&(c(),o=!1)}}}function Bt(s,e,t){const n={direction:"out"};let i=e(s,t,n),o=!0,r;const l=V;l.r+=1;let a;function c(){const{delay:h=0,duration:d=300,easing:u=ze,tick:p=N,css:f}=i||nt;f&&(r=Le(s,1,0,d,h,u,f));const y=ke()+h,b=y+d;W(()=>oe(s,!1,"start")),"inert"in s&&(a=s.inert,s.inert=!0),$e(m=>{if(o){if(m>=b)return p(0,1),oe(s,!1,"end"),--l.r||Z(l.c),!1;if(m>=y){const E=u((m-y)/d);p(1-E,E)}}return o})}return Te(i)?tt().then(()=>{i=i(n),c()}):c(),{end(h){h&&"inert"in s&&(s.inert=a),h&&i.tick&&i.tick(1,0),o&&(r&&Ne(s,r),o=!1)}}}function de(s,e,t,n){let o=e(s,t,{direction:"both"}),r=n?0:1,l=null,a=null,c=null,h;function d(){c&&Ne(s,c)}function u(f,y){const b=f.b-r;return y*=Math.abs(b),{a:r,b:f.b,d:b,duration:y,start:f.start,end:f.start+y,group:f.group}}function p(f){const{delay:y=0,duration:b=300,easing:m=ze,tick:E=N,css:k}=o||nt,C={start:ke()+y,b:f};f||(C.group=V,V.r+=1),"inert"in s&&(f?h!==void 0&&(s.inert=h):(h=s.inert,s.inert=!0)),l||a?a=C:(k&&(d(),c=Le(s,r,f,b,y,m,k)),f&&E(0,1),l=u(C,b),W(()=>oe(s,f,"start")),$e(T=>{if(a&&T>a.start&&(l=u(a,b),a=null,oe(s,l.b,"start"),k&&(d(),c=Le(s,r,l.b,l.duration,0,m,o.css))),l){if(T>=l.end)E(r=l.b,1-r),oe(s,l.b,"end"),a||(l.b?d():--l.group.r||Z(l.group.c)),l=null;else if(T>=l.start){const q=T-l.start;r=l.a+l.d*m(q/l.duration),E(r,1-r)}}return!!(l||a)}))}return{run(f){Te(o)?tt().then(()=>{o=o({direction:f?"in":"out"}),p(f)}):p(f)},end(){d(),l=a=null}}}function H(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function Mt(s,e){A(s,1,1,()=>{e.delete(s.key)})}function Dt(s,e,t,n,i,o,r,l,a,c,h,d){let u=s.length,p=o.length,f=u;const y={};for(;f--;)y[s[f].key]=f;const b=[],m=new Map,E=new Map,k=[];for(f=p;f--;){const v=d(i,o,f),j=t(v);let L=r.get(j);L?n&&k.push(()=>L.p(v,e)):(L=c(j,v),L.c()),m.set(j,b[f]=L),j in y&&E.set(j,Math.abs(f-y[j]))}const C=new Set,T=new Set;function q(v){P(v,1),v.m(l,h),r.set(v.key,v),h=v.first,p--}for(;u&&p;){const v=b[p-1],j=s[u-1],L=v.key,w=j.key;v===j?(h=v.first,u--,p--):m.has(w)?!r.has(L)||C.has(L)?q(v):T.has(w)?u--:E.get(L)>E.get(w)?(T.add(L),q(v)):(C.add(w),u--):(a(j,r),u--)}for(;u--;){const v=s[u];m.has(v.key)||a(v,r)}for(;p;)q(b[p-1]);return Z(k),b}function Be(s,e){const t={},n={},i={$$scope:1};let o=s.length;for(;o--;){const r=s[o],l=e[o];if(l){for(const a in r)a in l||(n[a]=1);for(const a in l)i[a]||(t[a]=l[a],i[a]=1);s[o]=l}else for(const a in r)i[a]=1}for(const r in n)r in t||(t[r]=void 0);return t}function Wt(s){return typeof s=="object"&&s!==null?s:{}}function Q(s){s&&s.c()}function K(s,e,t){const{fragment:n,after_update:i}=s.$$;n&&n.m(e,t),W(()=>{const o=s.$$.on_mount.map(Rt).filter(Te);s.$$.on_destroy?s.$$.on_destroy.push(...o):Z(o),s.$$.on_mount=[]}),i.forEach(W)}function G(s,e){const t=s.$$;t.fragment!==null&&(mn(t.after_update),Z(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function gn(s,e){s.$$.dirty[0]===-1&&(he.push(s),fn(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function X(s,e,t,n,i,o,r=null,l=[-1]){const a=Ce;ve(s);const c=s.$$={fragment:null,ctx:[],props:o,update:N,not_equal:i,bound:it(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:it(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let h=!1;if(c.ctx=t?t(s,e.props||{},(d,u,...p)=>{const f=p.length?p[0]:u;return c.ctx&&i(c.ctx[d],c.ctx[d]=f)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](f),h&&gn(s,d)),u}):[],c.update(),h=!0,Z(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const d=on(e.target);c.fragment&&c.fragment.l(d),d.forEach(I)}else c.fragment&&c.fragment.c();e.intro&&P(s.$$.fragment),K(s,e.target,e.anchor),$t()}ve(a)}class ee{constructor(){ae(this,"$$");ae(this,"$$set")}$destroy(){G(this,1),this.$destroy=N}$on(e,t){if(!Te(t))return N;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!tn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const bn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(bn);const ue=[];function Ue(s,e=N){let t;const n=new Set;function i(l){if(M(s,l)&&(s=l,t)){const a=!ue.length;for(const c of n)c[1](),ue.push(c,s);if(a){for(let c=0;c<ue.length;c+=2)ue[c][0](ue[c+1]);ue.length=0}}}function o(l){i(l(s))}function r(l,a=N){const c=[l,a];return n.add(c),n.size===1&&(t=e(i,o)||N),l(s),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:r}}function dt(s){return Object.prototype.toString.call(s)==="[object Date]"}function Je(s,e,t,n){if(typeof t=="number"||dt(t)){const i=n-t,o=(t-e)/(s.dt||1/60),r=s.opts.stiffness*i,l=s.opts.damping*o,a=(r-l)*s.inv_mass,c=(o+a)*s.dt;return Math.abs(c)<s.opts.precision&&Math.abs(i)<s.opts.precision?n:(s.settled=!1,dt(t)?new Date(t.getTime()+c):t+c)}else{if(Array.isArray(t))return t.map((i,o)=>Je(s,e[o],t[o],n[o]));if(typeof t=="object"){const i={};for(const o in t)i[o]=Je(s,e[o],t[o],n[o]);return i}else throw new Error(`Cannot spring ${typeof t} values`)}}function yn(s,e={}){const t=Ue(s),{stiffness:n=.15,damping:i=.8,precision:o=.01}=e;let r,l,a,c=s,h=s,d=1,u=0,p=!1;function f(b,m={}){h=b;const E=a={};return s==null||m.hard||y.stiffness>=1&&y.damping>=1?(p=!0,r=ke(),c=b,t.set(s=h),Promise.resolve()):(m.soft&&(u=1/((m.soft===!0?.5:+m.soft)*60),d=0),l||(r=ke(),p=!1,l=$e(k=>{if(p)return p=!1,l=null,!1;d=Math.min(d+u,1);const C={inv_mass:d,opts:y,settled:!0,dt:(k-r)*60/1e3},T=Je(C,c,s,h);return r=k,c=s,t.set(s=T),C.settled&&(l=null),!C.settled})),new Promise(k=>{l.promise.then(()=>{E===a&&k()})}))}const y={set:f,update:(b,m)=>f(b(h,s),m),subscribe:t.subscribe,stiffness:n,damping:i,precision:o};return y}function wn(s){return s<.5?4*s*s*s:.5*Math.pow(2*s-2,3)+1}function _n(s){const e=s-1;return e*e*e+1}function Y(s,{delay:e=0,duration:t=400,easing:n=ze}={}){const i=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:n,css:o=>`opacity: ${o*i}`}}function Sn(s,{delay:e=0,duration:t=400,easing:n=_n,x:i=0,y:o=0,opacity:r=0}={}){const l=getComputedStyle(s),a=+l.opacity,c=l.transform==="none"?"":l.transform,h=a*(1-r),[d,u]=lt(i),[p,f]=lt(o);return{delay:e,duration:t,easing:n,css:(y,b)=>`
			transform: ${c} translate(${(1-y)*d}${u}, ${(1-y)*p}${f});
			opacity: ${a-h*b}`}}const ne=15,we=!1;function vn(s){let e,t,n,i,o,r,l,a,c,h;return{c(){e=J("div"),t=se("svg"),n=se("path"),_(n,"d",i=s[8](s[1].path)),_(n,"class","svelte-qpq07z"),_(t,"width","100%"),_(t,"height","100%"),_(t,"viewBox",o=s[9](s[1].origin)),_(t,"preserveAspectRatio","none"),_(t,"fill","currentColor"),_(t,"class","svelte-qpq07z"),_(e,"role","cell"),_(e,"tabindex","-1"),_(e,"class","svelte-qpq07z"),B(e,"hidden",s[2]),D(e,"--y",`${s[3].y}%`),D(e,"--x",`${s[3].x}%`)},m(d,u){R(d,e,u),z(e,t),z(t,n),a=!0,c||(h=[te(window,"mousemove",s[5]),te(window,"touchmove",s[5]),te(window,"mouseup",s[7]),te(window,"touchend",s[7]),te(e,"mousedown",at(s[6])),te(e,"touchstart",at(s[6]))],c=!0)},p(d,[u]){s=d,(!a||u&2&&i!==(i=s[8](s[1].path)))&&_(n,"d",i),(!a||u&2&&o!==(o=s[9](s[1].origin)))&&_(t,"viewBox",o),(!a||u&4)&&B(e,"hidden",s[2]),u&8&&D(e,"--y",`${s[3].y}%`),u&8&&D(e,"--x",`${s[3].x}%`)},i(d){a||(W(()=>{a&&(l&&l.end(1),r=Ft(e,Y,{duration:100,delay:s[10]}),r.start())}),a=!0)},o(d){r&&r.invalidate(),l=Bt(e,Sn,{y:300,duration:2e3,delay:200+s[0]*100,easing:wn}),a=!1},d(d){d&&I(e),d&&l&&l.end(),c=!1,Z(h)}}}function kn(s,e,t){let n,{id:i}=e,{shapeSkin:o}=e,{hidden:r=!1}=e,{boardPoints:l=[]}=e,{blockSize:a=1}=e,c=!1,h={x:0,y:0},{shapePos:d={x:0,y:0}}=e,{shape:u=null}=e;const p=w=>w/a,f=()=>Math.random()*100,y=yn({x:f(),y:f()},{stiffness:.1,damping:.25});qt(s,y,w=>t(3,n=w));const b=w=>{let S=w.touches?w.touches[0]:w;return{x:S.clientX,y:S.clientY}},m=w=>{if(!c)return;const S=b(w);c&&y.set({x:p(S.x)*100-h.x,y:p(S.y)*100-h.y})},E=w=>{c=!0;const S=b(w),F=w.touches?30:0;h={x:p(S.x)*100-n.x,y:p(S.y+F)*100-n.y}},k=(w,S)=>l.flat().reduce((g,O)=>{const le=Math.sqrt((O.x-w)**2+(O.y-S)**2);return le<g.distance?{distance:le,point:O}:g},{distance:1/0,point:{x:0,y:0}}).point,C=(w,S=!1)=>{const{x:F,y:g}=k(w.x,w.y);y.set({x:F/ne*100,y:g/ne*100}),S&&(u==null||u.setPos({x:F+.5,y:g+.5}))},T=()=>{c&&(c=!1,C({x:n.x/100*ne,y:n.y/100*ne},!0))},q=w=>w.map((S,F)=>`${F===0?"M":"L"} ${S.x} ${S.y}`).join(" ")+" Z",v=(w,S={x:1,y:1})=>`${w.x} ${w.y} ${S.x} ${S.y}`;let j=100*i+500,L=!1;return Fe(()=>{setTimeout(()=>{t(15,L=!0)},j)}),s.$$set=w=>{"id"in w&&t(0,i=w.id),"shapeSkin"in w&&t(1,o=w.shapeSkin),"hidden"in w&&t(2,r=w.hidden),"boardPoints"in w&&t(11,l=w.boardPoints),"blockSize"in w&&t(12,a=w.blockSize),"shapePos"in w&&t(13,d=w.shapePos),"shape"in w&&t(14,u=w.shape)},s.$$.update=()=>{s.$$.dirty&40960&&L&&C(d)},[i,o,r,n,y,m,E,T,q,v,j,l,a,d,u,L]}class xt extends ee{constructor(e){super(),X(this,e,kn,vn,M,{id:0,shapeSkin:1,hidden:2,boardPoints:11,blockSize:12,shapePos:13,shape:14})}}class $ extends Error{constructor(e){var t,n,i,o;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,$.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof $||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(o=(i=(n=this.originalError)==null?void 0:n.cause)==null?void 0:i.message)!=null&&o.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const Ie=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Cn(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},e||{}).decode||On;let i=0;for(;i<s.length;){const o=s.indexOf("=",i);if(o===-1)break;let r=s.indexOf(";",i);if(r===-1)r=s.length;else if(r<o){i=s.lastIndexOf(";",o-1)+1;continue}const l=s.slice(i,o).trim();if(t[l]===void 0){let a=s.slice(o+1,r).trim();a.charCodeAt(0)===34&&(a=a.slice(1,-1));try{t[l]=n(a)}catch{t[l]=a}}i=r+1}return t}function ft(s,e,t){const n=Object.assign({},t||{}),i=n.encode||Pn;if(!Ie.test(s))throw new TypeError("argument name is invalid");const o=i(e);if(o&&!Ie.test(o))throw new TypeError("argument val is invalid");let r=s+"="+o;if(n.maxAge!=null){const l=n.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(l)}if(n.domain){if(!Ie.test(n.domain))throw new TypeError("option domain is invalid");r+="; Domain="+n.domain}if(n.path){if(!Ie.test(n.path))throw new TypeError("option path is invalid");r+="; Path="+n.path}if(n.expires){if(!function(a){return Object.prototype.toString.call(a)==="[object Date]"||a instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r}function On(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function Pn(s){return encodeURIComponent(s)}let Kt;function me(s){if(s)try{const e=decodeURIComponent(Kt(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Gt(s,e=0){let t=me(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}Kt=typeof atob=="function"?atob:s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,i=0,o=0,r="";n=e.charAt(o++);~n&&(t=i%4?64*t+n:n,i++%4)?r+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return r};const pt="pb_auth";class Tn{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!Gt(this.token)}get isAdmin(){return me(this.token).type==="admin"}get isAuthRecord(){return me(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=pt){const n=Cn(e||"")[t]||"";let i={};try{i=JSON.parse(n),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)}exportToCookie(e,t=pt){var a,c;const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},i=me(this.token);n.expires=i!=null&&i.exp?new Date(1e3*i.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const o={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let r=ft(t,JSON.stringify(o),e);const l=typeof Blob<"u"?new Blob([r]).size:r.length;if(o.model&&l>4096){o.model={id:(a=o==null?void 0:o.model)==null?void 0:a.id,email:(c=o==null?void 0:o.model)==null?void 0:c.email};const h=["collectionId","username","verified"];for(const d in this.model)h.includes(d)&&(o.model[d]=this.model[d]);r=ft(t,JSON.stringify(o),e)}return r}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class En extends Tn{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&(window!=null&&window.localStorage)){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window<"u"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class re{constructor(e){this.client=e}}class In extends re{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n){return n=Object.assign({method:"POST",body:{email:e,template:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(e,t,n,i,o,r){return r=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:i,duration:o}},r),this.client.send("/api/settings/apple/generate-client-secret",r)}}class st extends re{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(i=>{var o;return i.items=((o=i.items)==null?void 0:o.map(r=>this.decode(r)))||[],i})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{var i;if(!((i=n==null?void 0:n.items)!=null&&i.length))throw new $({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}async getOne(e,t){if(!e)throw new $({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(i=>this.decode(i))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],i=async o=>this.getList(o,e||500,t).then(r=>{const l=r.items;return n=n.concat(l),l.length==r.perPage?i(o+1):n});return i(1)}}function U(s,e,t,n){const i=n!==void 0;return i||t!==void 0?i?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function De(s){var e;(e=s._resetAutoRefresh)==null||e.call(s)}class An extends st{get baseCrudPath(){return"/api/admins"}async update(e,t,n){return super.update(e,t,n).then(i=>{var o,r;return((o=this.client.authStore.model)==null?void 0:o.id)===i.id&&((r=this.client.authStore.model)==null?void 0:r.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,i),i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,o;return n&&((i=this.client.authStore.model)==null?void 0:i.id)===e&&((o=this.client.authStore.model)==null?void 0:o.collectionId)===void 0&&this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,n,i){let o={method:"POST",body:{identity:e,password:t}};o=U("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",o,n,i);const r=o.autoRefreshThreshold;delete o.autoRefreshThreshold,o.autoRefresh||De(this.client);let l=await this.client.send(this.baseCrudPath+"/auth-with-password",o);return l=this.authResponse(l),r&&function(c,h,d,u){De(c);const p=c.beforeSend,f=c.authStore.model,y=c.authStore.onChange((b,m)=>{(!b||(m==null?void 0:m.id)!=(f==null?void 0:f.id)||(m!=null&&m.collectionId||f!=null&&f.collectionId)&&(m==null?void 0:m.collectionId)!=(f==null?void 0:f.collectionId))&&De(c)});c._resetAutoRefresh=function(){y(),c.beforeSend=p,delete c._resetAutoRefresh},c.beforeSend=async(b,m)=>{var T;const E=c.authStore.token;if((T=m.query)!=null&&T.autoRefresh)return p?p(b,m):{url:b,sendOptions:m};let k=c.authStore.isValid;if(k&&Gt(c.authStore.token,h))try{await d()}catch{k=!1}k||await u();const C=m.headers||{};for(let q in C)if(q.toLowerCase()=="authorization"&&E==C[q]&&c.authStore.token){C[q]=c.authStore.token;break}return m.headers=C,p?p(b,m):{url:b,sendOptions:m}}}(this.client,r,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},o))),l}async authRefresh(e,t){let n={method:"POST"};return n=U("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",n).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=U("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCrudPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return r=U("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",r,i,o),this.client.send(this.baseCrudPath+"/confirm-password-reset",r).then(()=>!0)}}const Rn=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Jt(s){if(s){s.query=s.query||{};for(let e in s)Rn.includes(e)||(s.query[e]=s[e],delete s[e])}}class Vt extends re{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){var r;if(!e)throw new Error("topic must be set.");let i=e;if(n){Jt(n);const l="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));i+=(i.includes("?")?"&":"?")+l}const o=function(l){const a=l;let c;try{c=JSON.parse(a==null?void 0:a.data)}catch{}t(c||{})};return this.subscriptions[i]||(this.subscriptions[i]=[]),this.subscriptions[i].push(o),this.isConnected?this.subscriptions[i].length===1?await this.submitSubscriptions():(r=this.eventSource)==null||r.addEventListener(i,o):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,o)}async unsubscribe(e){var n;let t=!1;if(e){const i=this.getSubscriptionsByTopic(e);for(let o in i)if(this.hasSubscriptionListeners(o)){for(let r of this.subscriptions[o])(n=this.eventSource)==null||n.removeEventListener(o,r);delete this.subscriptions[o],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var n;let t=!1;for(let i in this.subscriptions)if((i+"?").startsWith(e)){t=!0;for(let o of this.subscriptions[i])(n=this.eventSource)==null||n.removeEventListener(i,o);delete this.subscriptions[i]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var o;let n=!1;const i=this.getSubscriptionsByTopic(e);for(let r in i){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let l=!1;for(let a=this.subscriptions[r].length-1;a>=0;a--)this.subscriptions[r][a]===t&&(l=!0,delete this.subscriptions[r][a],this.subscriptions[r].splice(a,1),(o=this.eventSource)==null||o.removeEventListener(r,t));l&&(this.subscriptions[r].length||delete this.subscriptions[r],n||this.hasSubscriptionListeners(r)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,n;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let i in this.subscriptions)if((n=this.subscriptions[i])!=null&&n.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let i in n)for(let o of n[i])o(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new $(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[]}}}class qn extends st{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(i=>{var o,r,l;return((o=this.client.authStore.model)==null?void 0:o.id)!==(i==null?void 0:i.id)||((r=this.client.authStore.model)==null?void 0:r.collectionId)!==this.collectionIdOrName&&((l=this.client.authStore.model)==null?void 0:l.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,i),i})}async delete(e,t){return super.delete(e,t).then(n=>{var i,o,r;return!n||((i=this.client.authStore.model)==null?void 0:i.id)!==e||((o=this.client.authStore.model)==null?void 0:o.collectionId)!==this.collectionIdOrName&&((r=this.client.authStore.model)==null?void 0:r.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),n})}authResponse(e){const t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,n,i){let o={method:"POST",body:{identity:e,password:t}};return o=U("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/auth-with-password",o).then(r=>this.authResponse(r))}async authWithOAuth2Code(e,t,n,i,o,r,l){let a={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectUrl:i,createData:o}};return a=U("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",a,r,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(c=>this.authResponse(c))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const t=(e==null?void 0:e[0])||{},n=(await this.listAuthMethods()).authProviders.find(a=>a.name===t.provider);if(!n)throw new $(new Error(`Missing or invalid provider "${t.provider}".`));const i=this.client.buildUrl("/api/oauth2-redirect"),o=new Vt(this.client);let r=null;function l(){r==null||r.close(),o.unsubscribe()}return t.urlCallback||(r=mt(void 0)),new Promise(async(a,c)=>{var h;try{await o.subscribe("@oauth2",async f=>{const y=o.clientId;try{if(!f.state||y!==f.state)throw new Error("State parameters don't match.");if(f.error||!f.code)throw new Error("OAuth2 redirect error or missing code: "+f.error);const b=Object.assign({},t);delete b.provider,delete b.scopes,delete b.createData,delete b.urlCallback;const m=await this.authWithOAuth2Code(n.name,f.code,n.codeVerifier,i,t.createData,b);a(m)}catch(b){c(new $(b))}l()});const d={state:o.clientId};(h=t.scopes)!=null&&h.length&&(d.scope=t.scopes.join(" "));const u=this._replaceQueryParams(n.authUrl+i,d);await(t.urlCallback||function(f){r?r.location.href=f:r=mt(f)})(u)}catch(d){l(),c(new $(d))}})}async authRefresh(e,t){let n={method:"POST"};return n=U("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(i=>this.authResponse(i))}async requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=U("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}async confirmPasswordReset(e,t,n,i,o){let r={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return r=U("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",r,i,o),this.client.send(this.baseCollectionPath+"/confirm-password-reset",r).then(()=>!0)}async requestVerification(e,t,n){let i={method:"POST",body:{email:e}};return i=U("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}async confirmVerification(e,t,n){let i={method:"POST",body:{token:e}};return i=U("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>{const o=me(e),r=this.client.authStore.model;return r&&!r.verified&&r.id===o.id&&r.collectionId===o.collectionId&&(r.verified=!0,this.client.authStore.save(this.client.authStore.token,r)),!0})}async requestEmailChange(e,t,n){let i={method:"POST",body:{newEmail:e}};return i=U("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}async confirmEmailChange(e,t,n,i){let o={method:"POST",body:{token:e,password:t}};return o=U("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",o,n,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",o).then(()=>{const r=me(e),l=this.client.authStore.model;return l&&l.id===r.id&&l.collectionId===r.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),n).then(()=>!0)}_replaceQueryParams(e,t={}){let n=e,i="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const o={},r=i.split("&");for(const l of r){if(l=="")continue;const a=l.split("=");o[decodeURIComponent(a[0].replace(/\+/g," "))]=decodeURIComponent((a[1]||"").replace(/\+/g," "))}for(let l in t)t.hasOwnProperty(l)&&(t[l]==null?delete o[l]:o[l]=t[l]);i="";for(let l in o)o.hasOwnProperty(l)&&(i!=""&&(i+="&"),i+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(o[l].replace(/%20/g,"+")));return i!=""?n+"?"+i:n}}function mt(s){if(typeof window>"u"||!(window!=null&&window.open))throw new $(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,i=window.innerHeight;e=e>n?n:e,t=t>i?i:t;let o=n/2-e/2,r=i/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+r+",left="+o+",resizable,menubar=no")}class jn extends st{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}}class Ln extends re{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new $({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Nn extends re{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Un extends re{getUrl(e,t,n={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let o=this.client.buildUrl(i.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const r=new URLSearchParams(n);o+=(o.includes("?")?"&":"?")+r}return o}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}}class zn extends re{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class $n{constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=n,this.authStore=t||new En,this.admins=new An(this),this.collections=new jn(this),this.files=new Un(this),this.logs=new Ln(this),this.settings=new In(this),this.realtime=new Vt(this),this.health=new Nn(this),this.backups=new zn(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new qn(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let i=t[n];switch(typeof i){case"boolean":case"number":i=""+i;break;case"string":i="'"+i.replace(/'/g,"\\'")+"'";break;default:i=i===null?"null":i instanceof Date?"'"+i.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(i).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",i)}return e}getFileUrl(e,t,n={}){return this.files.getUrl(e,t,n)}buildUrl(e){var n;let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(n=window.location.origin)!=null&&n.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildUrl(e);if(this.beforeSend){const i=Object.assign({},await this.beforeSend(n,t));i.url!==void 0||i.options!==void 0?(n=i.url||n,t=i.options||t):Object.keys(i).length&&(t=i,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=this.serializeQueryParams(t.query);i&&(n+=(n.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async i=>{let o={};try{o=await i.json()}catch{}if(this.afterSend&&(o=await this.afterSend(i,o)),i.status>=400)throw new $({url:i.url,status:i.status,data:o});return o}).catch(i=>{throw new $(i)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),Jt(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const i=new AbortController;this.cancelControllers[n]=i,t.signal=i.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(const n in e){const i=e[n];if(typeof i!="object"||this.hasBlobField({data:i})){const o=Array.isArray(i)?i:[i];for(let r of o)t.append(n,r)}else{let o={};o[n]=i,t.append("@jsonPayload",JSON.stringify(o))}}return t}hasBlobField(e){for(const t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(const i of n)if(typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const n in e){if(e[n]===null)continue;const i=e[n],o=encodeURIComponent(n);if(Array.isArray(i))for(const r of i)t.push(o+"="+encodeURIComponent(r));else i instanceof Date?t.push(o+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(o+"="+encodeURIComponent(JSON.stringify(i))):t.push(o+"="+encodeURIComponent(i))}return t.join("&")}}function gt(s,e,t){const n=s.slice();return n[1]=e[t],n}function bt(s,e,t){const n=s.slice();return n[4]=e[t],n}function yt(s){let e,t,n;return{c(){e=se("circle"),_(e,"r",".1"),_(e,"cx",t=s[4].x),_(e,"cy",n=s[4].y)},m(i,o){R(i,e,o)},p(i,o){o&1&&t!==(t=i[4].x)&&_(e,"cx",t),o&1&&n!==(n=i[4].y)&&_(e,"cy",n)},d(i){i&&I(e)}}}function wt(s){let e,t=H(s[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=yt(bt(s,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=be()},m(i,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(i,o);R(i,e,o)},p(i,o){if(o&1){t=H(i[1]);let r;for(r=0;r<t.length;r+=1){const l=bt(i,t,r);n[r]?n[r].p(l,o):(n[r]=yt(l),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&I(e),et(n,i)}}}function Fn(s){let e,t,n,i,o=H(s[0].boardPoints),r=[];for(let l=0;l<o.length;l+=1)r[l]=wt(gt(s,o,l));return{c(){e=se("svg");for(let l=0;l<r.length;l+=1)r[l].c();_(e,"width","100%"),_(e,"height","100%"),_(e,"viewBox",t=`0 0 ${s[0].boardSize} ${s[0].boardSize}`),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"fill","black"),_(e,"class","svelte-1o5z4u5")},m(l,a){R(l,e,a);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);i=!0},p(l,[a]){if(a&1){o=H(l[0].boardPoints);let c;for(c=0;c<o.length;c+=1){const h=gt(l,o,c);r[c]?r[c].p(h,a):(r[c]=wt(h),r[c].c(),r[c].m(e,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}(!i||a&1&&t!==(t=`0 0 ${l[0].boardSize} ${l[0].boardSize}`))&&_(e,"viewBox",t)},i(l){i||(n&&n.end(1),i=!0)},o(l){l&&(n=Bt(e,Y,{})),i=!1},d(l){l&&I(e),et(r,l),l&&n&&n.end()}}}function Bn(s,e,t){let{board:n}=e;return s.$$set=i=>{"board"in i&&t(0,n=i.board)},[n]}class Mn extends ee{constructor(e){super(),X(this,e,Bn,Fn,M,{board:0})}}function Dn(s){let e,t,n,i,o,r,l;return{c(){e=J("div"),t=se("svg"),n=se("path"),_(n,"d",i=s[2](s[0].path)),_(n,"class","svelte-1p7gz00"),_(t,"width","100%"),_(t,"height","100%"),_(t,"viewBox",o=s[3](s[0].origin)),_(t,"preserveAspectRatio","none"),_(t,"fill","currentColor"),_(t,"class","svelte-1p7gz00"),_(e,"role","cell"),_(e,"tabindex","-1"),_(e,"class","svelte-1p7gz00"),D(e,"--y",`${s[1].x}%`),D(e,"--x",`${s[1].y}%`),D(e,"--board-size",ne/_e)},m(a,c){R(a,e,c),z(e,t),z(t,n),l=!0},p(a,[c]){(!l||c&1&&i!==(i=a[2](a[0].path)))&&_(n,"d",i),(!l||c&1&&o!==(o=a[3](a[0].origin)))&&_(t,"viewBox",o),c&2&&D(e,"--y",`${a[1].x}%`),c&2&&D(e,"--x",`${a[1].y}%`)},i(a){l||(W(()=>{l&&(r||(r=de(e,Y,{duration:1e3},!0)),r.run(1))}),l=!0)},o(a){r||(r=de(e,Y,{duration:1e3},!1)),r.run(0),l=!1},d(a){a&&I(e),a&&r&&r.end()}}}let _e=2.5;function Wn(s,e,t){let n,{shapeSkin:i}=e,{shapePos:o={x:0,y:0}}=e;const r=a=>a.map((c,h)=>`${h===0?"M":"L"} ${c.x} ${c.y}`).join(" ")+" Z",l=(a,c={x:1,y:1})=>`${a.x} ${a.y} ${c.x} ${c.y}`;return s.$$set=a=>{"shapeSkin"in a&&t(0,i=a.shapeSkin),"shapePos"in a&&t(4,o=a.shapePos)},s.$$.update=()=>{s.$$.dirty&16&&t(1,n={x:(o.y-.5)*100*_e/ne-50*(_e-1),y:(o.x-.5)*100*_e/ne-50*(_e-1)})},[i,n,r,l,o]}class xn extends ee{constructor(e){super(),X(this,e,Wn,Dn,M,{shapeSkin:0,shapePos:4})}}let Ve=Ue({});const _t=(s,e)=>Math.round(s*10**e)/10**e;let Ht={};Ve.subscribe(s=>{Ht=s});class We{constructor(e,t,n,i){this.id=t,this.pos=n||{x:8,y:8},this.skin=i||"square",this.boardRef=e}setPos(e){this.pos=e,this.boardRef.checkBoardState()}loadSkin(){return Ht[this.skin]}}class Kn{constructor(e){this.boardSize=e||15,this.boardShapes$=Ue([]),this.boardPoints=this.generateBoardSnapPoints(this.boardSize),this.currentLevel=1,this.final=[],this.levelCompleted$=Ue(!1)}addShape(e,t){this.boardShapes$.update(n=>{const i=new We(this,n.length+1,e,t);return[...n,i]})}setupLevel(e,t){this.currentLevel=t+1,this.boardShapes$.set(e.start.map((i,o)=>new We(this,o,i.pos,i.skin))),this.finalCenter=this.findCenterFromShapes(e.final);const n=this.relativeToCenter(this.finalCenter,{x:this.boardSize/2+.5,y:this.boardSize/2+.5});this.final=e.final.map((i,o)=>new We(null,o,this.relativeToCenter(i.pos,n),i.skin))}findCenterFromShapes(e){const t=e.reduce((n,i)=>({x:n.x+i.pos.x,y:n.y+i.pos.y}),{x:0,y:0});return{x:t.x/e.length,y:t.y/e.length}}relativeToCenter(e,t){return{x:_t(e.x-t.x,2),y:_t(e.y-t.y,2)}}getJSON(e){return JSON.stringify(e.map(({boardRef:t,id:n,...i})=>i))}checkBoardState(e=!1){this.boardShapes$.update(t=>(e?console.log(this.getJSON(t)):this.levelCompleted$.update(()=>this.checkLevelCompletion(t)),t))}areCoordsSame(e,t){return e.x===t.x&&e.y===t.y}checkLevelCompletion(e){const t=this.final,n=this.findCenterFromShapes(e),i=this.findCenterFromShapes(t),o=t.map(r=>({skin:r.skin,pos:this.relativeToCenter(r.pos,i)}));return e.every((r,l)=>{const a=this.relativeToCenter(r.pos,n);return o.some(c=>c.skin===r.skin&&this.areCoordsSame(a,c.pos))})}generateBoardSnapPoints(e){const t=(n,i,o)=>Math.sqrt(n**2+i**2)<=o;return Array(e).fill().map((n,i)=>Array(e).fill().map((o,r)=>({x:i+.5,y:r+.5})).filter((o,r)=>t(o.x/e-.5,o.y/e-.5,.5)))}}/**
 * @license lucide-svelte v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},St=Gn;function vt(s,e,t){const n=s.slice();return n[10]=e[t][0],n[11]=e[t][1],n}function xe(s){let e,t=[s[11]],n={};for(let i=0;i<t.length;i+=1)n=x(n,t[i]);return{c(){e=se(s[10]),Re(e,n)},m(i,o){R(i,e,o)},p(i,o){Re(e,n=Be(t,[o&32&&i[11]]))},d(i){i&&I(e)}}}function kt(s){let e=s[10],t,n=s[10]&&xe(s);return{c(){n&&n.c(),t=be()},m(i,o){n&&n.m(i,o),R(i,t,o)},p(i,o){i[10]?e?M(e,i[10])?(n.d(1),n=xe(i),e=i[10],n.c(),n.m(t.parentNode,t)):n.p(i,o):(n=xe(i),e=i[10],n.c(),n.m(t.parentNode,t)):e&&(n.d(1),n=null,e=i[10])},d(i){i&&I(t),n&&n.d(i)}}}function Jn(s){let e,t,n,i,o,r=H(s[5]),l=[];for(let u=0;u<r.length;u+=1)l[u]=kt(vt(s,r,u));const a=s[9].default,c=He(a,s,s[8],null);let h=[St,s[6],{width:s[2]},{height:s[2]},{stroke:s[1]},{"stroke-width":n=s[4]?Number(s[3])*24/Number(s[2]):s[3]},{class:i=`lucide-icon lucide lucide-${s[0]} ${s[7].class??""}`}],d={};for(let u=0;u<h.length;u+=1)d=x(d,h[u]);return{c(){e=se("svg");for(let u=0;u<l.length;u+=1)l[u].c();t=be(),c&&c.c(),Re(e,d)},m(u,p){R(u,e,p);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);z(e,t),c&&c.m(e,null),o=!0},p(u,[p]){if(p&32){r=H(u[5]);let f;for(f=0;f<r.length;f+=1){const y=vt(u,r,f);l[f]?l[f].p(y,p):(l[f]=kt(y),l[f].c(),l[f].m(e,t))}for(;f<l.length;f+=1)l[f].d(1);l.length=r.length}c&&c.p&&(!o||p&256)&&Ze(c,a,u,u[8],o?Qe(a,u[8],p,null):Ye(u[8]),null),Re(e,d=Be(h,[St,p&64&&u[6],(!o||p&4)&&{width:u[2]},(!o||p&4)&&{height:u[2]},(!o||p&2)&&{stroke:u[1]},(!o||p&28&&n!==(n=u[4]?Number(u[3])*24/Number(u[2]):u[3]))&&{"stroke-width":n},(!o||p&129&&i!==(i=`lucide-icon lucide lucide-${u[0]} ${u[7].class??""}`))&&{class:i}]))},i(u){o||(P(c,u),o=!0)},o(u){A(c,u),o=!1},d(u){u&&I(e),et(l,u),c&&c.d(u)}}}function Vn(s,e,t){const n=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"];let i=ot(e,n),{$$slots:o={},$$scope:r}=e,{name:l}=e,{color:a="currentColor"}=e,{size:c=24}=e,{strokeWidth:h=2}=e,{absoluteStrokeWidth:d=!1}=e,{iconNode:u}=e;return s.$$set=p=>{t(7,e=x(x({},e),ge(p))),t(6,i=ot(e,n)),"name"in p&&t(0,l=p.name),"color"in p&&t(1,a=p.color),"size"in p&&t(2,c=p.size),"strokeWidth"in p&&t(3,h=p.strokeWidth),"absoluteStrokeWidth"in p&&t(4,d=p.absoluteStrokeWidth),"iconNode"in p&&t(5,u=p.iconNode),"$$scope"in p&&t(8,r=p.$$scope)},e=ge(e),[l,a,c,h,d,u,i,e,r,o]}class Qt extends ee{constructor(e){super(),X(this,e,Vn,Jn,M,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5})}}function Hn(s){let e;const t=s[2].default,n=He(t,s,s[3],null);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8)&&Ze(n,t,i,i[3],e?Qe(t,i[3],o,null):Ye(i[3]),null)},i(i){e||(P(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function Qn(s){let e,t;const n=[{name:"chevron-left"},s[1],{iconNode:s[0]}];let i={$$slots:{default:[Hn]},$$scope:{ctx:s}};for(let o=0;o<n.length;o+=1)i=x(i,n[o]);return e=new Qt({props:i}),{c(){Q(e.$$.fragment)},m(o,r){K(e,o,r),t=!0},p(o,[r]){const l=r&3?Be(n,[n[0],r&2&&Wt(o[1]),r&1&&{iconNode:o[0]}]):{};r&8&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(P(e.$$.fragment,o),t=!0)},o(o){A(e.$$.fragment,o),t=!1},d(o){G(e,o)}}}function Zn(s,e,t){let{$$slots:n={},$$scope:i}=e;const o=[["path",{d:"m15 18-6-6 6-6"}]];return s.$$set=r=>{t(1,e=x(x({},e),ge(r))),"$$scope"in r&&t(3,i=r.$$scope)},e=ge(e),[o,e,n,i]}class Yn extends ee{constructor(e){super(),X(this,e,Zn,Qn,M,{})}}function Xn(s){let e;const t=s[2].default,n=He(t,s,s[3],null);return{c(){n&&n.c()},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8)&&Ze(n,t,i,i[3],e?Qe(t,i[3],o,null):Ye(i[3]),null)},i(i){e||(P(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function es(s){let e,t;const n=[{name:"chevron-right"},s[1],{iconNode:s[0]}];let i={$$slots:{default:[Xn]},$$scope:{ctx:s}};for(let o=0;o<n.length;o+=1)i=x(i,n[o]);return e=new Qt({props:i}),{c(){Q(e.$$.fragment)},m(o,r){K(e,o,r),t=!0},p(o,[r]){const l=r&3?Be(n,[n[0],r&2&&Wt(o[1]),r&1&&{iconNode:o[0]}]):{};r&8&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(P(e.$$.fragment,o),t=!0)},o(o){A(e.$$.fragment,o),t=!1},d(o){G(e,o)}}}function ts(s,e,t){let{$$slots:n={},$$scope:i}=e;const o=[["path",{d:"m9 18 6-6-6-6"}]];return s.$$set=r=>{t(1,e=x(x({},e),ge(r))),"$$scope"in r&&t(3,i=r.$$scope)},e=ge(e),[o,e,n,i]}class ns extends ee{constructor(e){super(),X(this,e,ts,es,M,{})}}function ss(s){let e,t;return e=new xt({props:{id:1,shapePos:{x:8,y:8},boardPoints:s[1].boardPoints,blockSize:s[2],shapeSkin:s[3],hidden:!s[0]}}),{c(){Q(e.$$.fragment)},m(n,i){K(e,n,i),t=!0},p(n,[i]){const o={};i&2&&(o.boardPoints=n[1].boardPoints),i&4&&(o.blockSize=n[2]),i&1&&(o.hidden=!n[0]),e.$set(o)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){G(e,n)}}}function is(s,e,t){let{isOpen:n=!1}=e,{board:i}=e,{blockSize:o=1}=e;const r={origin:{x:.5,y:.5},path:[{x:.46,y:.21},{x:.54,y:.21},{x:.54,y:.46},{x:.79,y:.46},{x:.79,y:.54},{x:.54,y:.54},{x:.54,y:.79},{x:.46,y:.79},{x:.46,y:.54},{x:.21,y:.54},{x:.21,y:.46},{x:.46,y:.46}]};return Fe(()=>{}),s.$$set=l=>{"isOpen"in l&&t(0,n=l.isOpen),"board"in l&&t(1,i=l.board),"blockSize"in l&&t(2,o=l.blockSize)},[n,i,o,r]}class os extends ee{constructor(e){super(),X(this,e,is,ss,M,{isOpen:0,board:1,blockSize:2})}}function Ct(s,e,t){const n=s.slice();return n[22]=e[t],n}function Ot(s,e,t){const n=s.slice();return n[22]=e[t],n[26]=t,n}function Pt(s,e){let t,n,i;return n=new xn({props:{shapePos:e[22].pos,shapeSkin:e[22].loadSkin()}}),{key:s,first:null,c(){t=be(),Q(n.$$.fragment),this.first=t},m(o,r){R(o,t,r),K(n,o,r),i=!0},p(o,r){e=o;const l={};r&8&&(l.shapePos=e[22].pos),r&8&&(l.shapeSkin=e[22].loadSkin()),n.$set(l)},i(o){i||(P(n.$$.fragment,o),i=!0)},o(o){A(n.$$.fragment,o),i=!1},d(o){o&&I(t),G(n,o)}}}function Tt(s){let e=[],t=new Map,n,i,o=H(s[3]);const r=l=>l[26];for(let l=0;l<o.length;l+=1){let a=Ot(s,o,l),c=r(a);t.set(c,e[l]=Pt(c,a))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();n=be()},m(l,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(l,a);R(l,n,a),i=!0},p(l,a){a&8&&(o=H(l[3]),Oe(),e=Dt(e,a,r,1,l,o,t,n.parentNode,Mt,Pt,n,Ot),Pe())},i(l){if(!i){for(let a=0;a<o.length;a+=1)P(e[a]);i=!0}},o(l){for(let a=0;a<e.length;a+=1)A(e[a]);i=!1},d(l){l&&I(n);for(let a=0;a<e.length;a+=1)e[a].d(l)}}}function Et(s){let e=[],t=new Map,n,i,o,r,l,a=H(s[9]);const c=h=>h[22].id;for(let h=0;h<a.length;h+=1){let d=Ct(s,a,h),u=c(d);t.set(u,e[h]=It(u,d))}return i=new Mn({props:{board:s[10]}}),r=new os({props:{board:s[10],isOpen:s[2],blockSize:s[7]}}),{c(){for(let h=0;h<e.length;h+=1)e[h].c();n=ie(),Q(i.$$.fragment),o=ie(),Q(r.$$.fragment)},m(h,d){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(h,d);R(h,n,d),K(i,h,d),R(h,o,d),K(r,h,d),l=!0},p(h,d){d&1668&&(a=H(h[9]),Oe(),e=Dt(e,d,c,1,h,a,t,n.parentNode,Mt,It,n,Ct),Pe());const u={};d&4&&(u.isOpen=h[2]),d&128&&(u.blockSize=h[7]),r.$set(u)},i(h){if(!l){for(let d=0;d<a.length;d+=1)P(e[d]);P(i.$$.fragment,h),P(r.$$.fragment,h),l=!0}},o(h){for(let d=0;d<e.length;d+=1)A(e[d]);A(i.$$.fragment,h),A(r.$$.fragment,h),l=!1},d(h){h&&(I(n),I(o));for(let d=0;d<e.length;d+=1)e[d].d(h);G(i,h),G(r,h)}}}function It(s,e){let t,n,i;return n=new xt({props:{id:e[22].id,shapePos:e[22].pos,boardPoints:e[10].boardPoints,blockSize:e[7],shapeSkin:e[22].loadSkin(),shape:e[22],hidden:e[2]}}),{key:s,first:null,c(){t=be(),Q(n.$$.fragment),this.first=t},m(o,r){R(o,t,r),K(n,o,r),i=!0},p(o,r){e=o;const l={};r&512&&(l.id=e[22].id),r&512&&(l.shapePos=e[22].pos),r&128&&(l.blockSize=e[7]),r&512&&(l.shapeSkin=e[22].loadSkin()),r&512&&(l.shape=e[22]),r&4&&(l.hidden=e[2]),n.$set(l)},i(o){i||(P(n.$$.fragment,o),i=!0)},o(o){A(n.$$.fragment,o),i=!1},d(o){o&&I(t),G(n,o)}}}function rs(s){let e,t=s[1]+1+"",n,i,o,r,l,a=s[1],c,h,d,u,p,f,y,b,m,E,k,C,T,q,v,j,L,w=Tt(s),S=!s[8]&&Et(s);b=new Yn({props:{color:"black",size:"1em"}}),C=new ns({props:{color:"black",size:"1em"}});let F=we;return{c(){e=J("span"),n=Se(t),i=Se("/"),o=Se(s[4]),r=ie(),l=J("div"),w.c(),c=ie(),h=J("div"),S&&S.c(),p=ie(),f=J("nav"),y=J("button"),Q(b.$$.fragment),E=ie(),k=J("button"),Q(C.$$.fragment),q=ie(),_(e,"class","svelte-h6o05v"),B(e,"active",s[8]),_(l,"class","preview svelte-h6o05v"),B(l,"completed",s[8]),D(l,"--board-size",s[10].boardSize),_(h,"class","board svelte-h6o05v"),B(h,"completed",s[8]),D(h,"--board-size",s[10].boardSize),_(y,"class","svelte-h6o05v"),B(y,"active",s[8]||we),_(k,"class","svelte-h6o05v"),B(k,"active",s[8]||we),_(f,"class","svelte-h6o05v")},m(g,O){R(g,e,O),z(e,n),z(e,i),z(e,o),R(g,r,O),R(g,l,O),w.m(l,null),R(g,c,O),R(g,h,O),S&&S.m(h,null),d=rn.observe(h,s[12].bind(h)),R(g,p,O),R(g,f,O),z(f,y),K(b,y,null),z(f,E),z(f,k),K(C,k,null),z(f,q),v=!0,j||(L=[te(y,"click",s[13]),te(k,"click",s[14])],j=!0)},p(g,[O]){(!v||O&2)&&t!==(t=g[1]+1+"")&&ct(n,t),(!v||O&16)&&ct(o,g[4]),(!v||O&256)&&B(e,"active",g[8]),O&2&&M(a,a=g[1])?(Oe(),A(w,1,1,N),Pe(),w=Tt(g),w.c(),P(w,1),w.m(l,null)):w.p(g,O),(!v||O&256)&&B(l,"completed",g[8]),g[8]?S&&(Oe(),A(S,1,1,()=>{S=null}),Pe()):S?(S.p(g,O),O&256&&P(S,1)):(S=Et(g),S.c(),P(S,1),S.m(h,null)),(!v||O&256)&&B(h,"completed",g[8]),(!v||O&256)&&B(y,"active",g[8]||we),(!v||O&256)&&B(k,"active",g[8]||we)},i(g){v||(P(w),P(S),u||W(()=>{u=Ft(h,Y,{duration:500}),u.start()}),P(b.$$.fragment,g),g&&W(()=>{v&&(m||(m=de(y,Y,{},!0)),m.run(1))}),P(C.$$.fragment,g),g&&W(()=>{v&&(T||(T=de(k,Y,{},!0)),T.run(1))}),P(F),v=!0)},o(g){A(w),A(S),A(b.$$.fragment,g),g&&(m||(m=de(y,Y,{},!1)),m.run(0)),A(C.$$.fragment,g),g&&(T||(T=de(k,Y,{},!1)),T.run(0)),A(F),v=!1},d(g){g&&(I(e),I(r),I(l),I(c),I(h),I(p),I(f)),w.d(g),S&&S.d(),d(),G(b),g&&m&&m.end(),G(C),g&&T&&T.end(),j=!1,Z(L)}}}function ls(s,e,t){let n,i,o,r,l,a=N,c=()=>(a(),a=Ke(o,g=>t(8,l=g)),o),h,d=N,u=()=>(d(),d=Ke(i,g=>t(9,h=g)),i);qt(s,Ve,g=>t(17,r=g)),s.$$.on_destroy.push(()=>a()),s.$$.on_destroy.push(()=>d());const p=new $n("https://db.cubiq.dev/");let f=0,y=!1,b;const m=new Kn(ne);let E=[];const k=async()=>{const g=await p.collection("levels").getList(1,1).catch(le=>console.error(le)),{totalItems:O}=g||{totalItems:0};return O},C=async g=>{p.collection("levels").getFirstListItem("levelId="+g).then(O=>{rt(o,l=!1,l),m.setupLevel(O,g),t(3,E=m.final)}).catch(O=>{console.error(O)})},T=async()=>{try{const O=(await p.collection("skins").getFullList()).map(({skin:le,path:Zt,origin:Yt})=>({[le]:{path:Zt,origin:Yt}}));rt(Ve,r=Object.assign({},...O),r)}catch(g){console.error(g)}};let q=0;const v=(g=1)=>{t(1,f=(f+g+q)%q),C(f)};Fe(async()=>{T(),t(4,q=await k()),t(1,f=0),C(f)});function j(){var g;b=(g=Ee.entries.get(this))==null?void 0:g.borderBoxSize,t(0,b)}const L=()=>v(-1),w=()=>v(),S=()=>m.checkBoardState(!0),F=()=>t(2,y=!y);return s.$$.update=()=>{s.$$.dirty&1&&t(7,n=b?b[0].blockSize:0)},u(t(6,i=m.boardShapes$)),c(t(5,o=m.levelCompleted$)),[b,f,y,E,q,o,i,n,l,h,m,v,j,L,w,S,F]}class as extends ee{constructor(e){super(),X(this,e,ls,rs,M,{})}}function At(s){let e,t;return e=new as({}),{c(){Q(e.$$.fragment)},m(n,i){K(e,n,i),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){G(e,n)}}}function cs(s){let e,t,n=s[0]&&At();return{c(){e=J("main"),n&&n.c(),_(e,"class","svelte-udrhtm")},m(i,o){R(i,e,o),n&&n.m(e,null),t=!0},p(i,[o]){i[0]?n?o&1&&P(n,1):(n=At(),n.c(),P(n,1),n.m(e,null)):n&&(Oe(),A(n,1,1,()=>{n=null}),Pe())},i(i){t||(P(n),t=!0)},o(i){A(n),t=!1},d(i){i&&I(e),n&&n.d()}}}function us(s,e,t){let n=!1;return Fe(()=>{setTimeout(()=>{t(0,n=!0)},300)}),[n]}class hs extends ee{constructor(e){super(),X(this,e,us,cs,M,{})}}new hs({target:document.getElementById("app")});
